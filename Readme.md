# AdamRMS — self‑hosted инвентаризация, проекты, уведомления

Этот репозиторий содержит серверную часть AdamRMS — многофункциональной self‑hosted системы для управления оборудованием, проектами, пользователями и уведомлениями. Проект написан на PHP 8, использует Twig для серверных шаблонов, MySQL в качестве СУБД, Phinx для миграций, и интеграции с почтовыми сервисами, S3‑совместимым хранилищем и Stripe. Для быстрого старта предусмотрены Dockerfile и docker‑compose, а также полноценная Dev Container конфигурация.

Ниже — подробная, практичная и исчерпывающая документация по установке, конфигурации, структуре кода и ключевым подсистемам. Если вы только начинаете, начните с «Быстрый старт».

**Содержание**
- Быстрый старт
- Возможности
- Архитектура и зависимости
- Структура репозитория
- Установка и запуск (Docker / DevContainer / вручную)
- Конфигурация (через UI и переменные окружения)
- Почтовые уведомления и шаблоны
- Файловое хранилище (S3) и CDN
- Аутентификация, права и сессии
- Уведомления в системе
- API и OpenAPI
- Миграции и данные по умолчанию
- Разработка и отладка
- Безопасность и продакшен‑настройки
- Обновление и обслуживание
- Частые проблемы и диагностика
- Лицензия

**Важно**: по умолчанию проект развернётся с дефолтным пользователем. Сразу после первого входа смените пароль и пройдите базовую настройку конфигурации в Server → Config.

## Быстрый старт

Вариант A — docker‑compose (локальная среда):
- Убедитесь, что установлен Docker и docker‑compose.
- Проверьте файл `.env` в корне. В нём должен быть `MYSQL_ROOT_PASSWORD` (по умолчанию присутствует). Пример: `MYSQL_ROOT_PASSWORD=strongpassword`.
- Запустите: `docker compose up -d`.
- Приложение доступно на `http://localhost:8088` (настройка в `docker-compose.yml`:8088→80).
- При первом старте контейнер автоматически применит миграции и сиды, затем запустит Apache (см. `migrate.sh`).

Дефолтные креды (после сидов):
- Логин: `username`
- Пароль: `password!`

После входа откройте Server → Config и заполните обязательные параметры (как минимум `Root URL`).

Вариант B — Dev Container (VS Code):
- Откройте репо в VS Code → «Reopen in Container».
- Поднимутся сервисы: MySQL, S3 mock, phpMyAdmin, Mailpit. Порты:
  - Веб: `http://localhost:8080`
  - S3 mock: `http://localhost:8081`
  - phpMyAdmin: `https://localhost:8082`
  - Mailpit UI (почта для разработки): `http://localhost:8083`
- Миграции и сиды выполняются автоматически (`postStartCommand`).

## Возможности
- Многоарендность («instances») и права доступа на уровне сервера и инстанса.
- Учёт оборудования и типов, штрих‑коды, истории сканирований, группы.
- Проекты: состав команды, статусы, планирование, привязка активов к проектам.
- Техобслуживание: заявки, статусы, назначение, уведомления.
- Клиенты и локации, CMS‑страницы для дашборда.
- Уведомления по email через Sendgrid/Mailgun/Postmark/SMTP; шаблоны на Twig.
- Хранилище файлов (S3‑совместимое), загрузки из браузера и сервера, опциональный CDN.
- OAuth вход: Google и Microsoft, magic‑links, JWT для приложений.
- Экспорт календаря (iCal), генерация QR/штрих‑кодов, экосистема OpenAPI аннотаций.

## Архитектура и зависимости
- Язык/стек: PHP 8.x + Apache (см. `Dockerfile`), Twig 3.x, Composer зависимости (`composer.json`).
- База данных: MySQL 8 (`db/`, Phinx миграции `phinx.php`).
- Обязательные расширения PHP: `mysqli`, `intl`, `gd`, `zip` (см. `Dockerfile`).
- Ключевые пакеты:
  - `twig/twig` — шаблоны интерфейса и писем.
  - `robmorgan/phinx` — миграции БД и сиды.
  - `aws/aws-sdk-php` — S3 / CloudFront.
  - Почта: `sendgrid/sendgrid`, `mailgun/mailgun-php`, `wildbit/postmark-php`, `phpmailer/phpmailer`.
  - Аутентификация: `firebase/php-jwt`, `hybridauth/hybridauth` (OAuth Google/Microsoft).
  - Деньги/валюта: `moneyphp/money`.
  - Баркоды/QR: `picqer/php-barcode-generator`, `bacon/bacon-qr-code`.
  - Документация API: `zircote/swagger-php` (OpenAPI аннотации).

## Структура репозитория
- `src/` — корень веб‑приложения (Apache DocumentRoot перенаправлен сюда).
  - `index.php` — дашборд/роутинг главной: `src/index.php:1`.
  - `common/` — общие либы, конфиг, Twig, CSP, Sentry и т. п.
    - `common/head.php` — инициализация Twig, БД, конфигурации, CSP, Sentry: `src/common/head.php:1`.
    - `common/libs/Config/` — схема конфигурации и UI формы: `src/common/libs/Config/configStructureArray.php:1`.
    - `common/libs/Auth/` — аутентификация, токены, права, телеметрия: `src/common/libs/Auth/main.php:1`.
    - `common/libs/Email/` — провайдеры почты и логирование писем: `src/common/libs/Email/EmailHandler.php:1`.
    - `common/libs/twigExtensions.php` — расширения Twig (фильтры/функции): `src/common/libs/twigExtensions.php:1`.
  - `api/` — REST эндпоинты, аннотации OpenAPI.
    - `api/apiHead.php` — общий заголовок JSON API (CORS, payload mirroring): `src/api/apiHead.php:1`.
    - `api/apiHeadSecure.php` — проверка авторизации для защищённых эндпоинтов: `src/api/apiHeadSecure.php:1`.
    - `api/notifications/` — система уведомлений (типизация и отправка писем).
    - другие модули: `assets/`, `projects/`, `instances/`, `maintenance/`, `file/`, `s3files/`, `cms/` и т. д.
  - `login/` — страницы входа, регистрации и OAuth: `src/login/index.php:1`.
  - `server/` — серверная админка (права, пользователи, аудит, конфигурация).
  - `.htaccess` — обработка 404: `src/.htaccess:1`.
- `db/` — миграции (`db/migrations`) и сиды (`db/seeds`).
- `phinx.php` — конфиг Phinx (подхватывает `DB_*` из окружения): `phinx.php:1`.
- `migrate.sh` — entrypoint контейнера: миграции+сиды, затем Apache: `migrate.sh:1`.
- `Dockerfile` — PHP 8.3 Apache образ с зависимостями.
- `docker-compose.yml` — локальная сборка (app + MySQL).
- `.devcontainer/` — расширенная среда разработки (S3 mock, phpMyAdmin, Mailpit).

## Установка и запуск

Вариант A — Docker Compose (прод/локалка):
- Проверьте `.env` (значение `MYSQL_ROOT_PASSWORD`).
- Запустите: `docker compose up -d`.
- БД: контейнер `adamrms_db` (MySQL 8), порт `3306` проброшен наружу.
- Приложение: контейнер `adamrms_app`, порт `8088` → `80` (Apache).
- При старте `adamrms_app` выполнит `phinx migrate` и `phinx seed:run` (см. `migrate.sh`).

Вариант B — VS Code Dev Container:
- Откройте репозиторий в контейнере, дождитесь `postCreateCommand`: `composer install` и последующих миграций.
- Присутствуют сервисы: `db`, `s3filestore`, `phpmyadmin`, `mailpit` (см. `.devcontainer/docker-compose.yml:1`).
- Переменные окружения для контейнера `app` инициализируют file‑storage, SMTP и root URL.

Вариант C — ручной деплой без Docker:
- Требования: PHP 8.0+, расширения `mysqli`, `intl`, `gd`, `zip`; веб‑сервер (Apache/Nginx), MySQL 8.
- `composer install` в корне проекта.
- Настройте виртуальный хост так, чтобы DocumentRoot указывал на `src/`.
- Пропишите переменные окружения (см. раздел «Конфигурация» ниже) или задайте их через Systemd/Apache env.
- Выполните миграции и сиды: `php vendor/bin/phinx migrate -e production && php vendor/bin/phinx seed:run -e production`.

## Конфигурация

Конфигурация хранится в БД (таблица `config`) согласно схеме `configStructureArray.php` и подхватывает значения из переменных окружения, если ключ присутствует (envFallback). При первой загрузке UI предложит заполнить недостающие поля через встроенную форму.

Минимальные переменные окружения БД (всегда):
- `DB_HOSTNAME`, `DB_DATABASE`, `DB_USERNAME`, `DB_PASSWORD`, `DB_PORT` (опционально, по умолчанию 3306)
- `DEV_MODE` — `true` включает подробные ошибки и отключает Twig‑кэш.

Ключевые конфиги через UI/ENV:
- Общие:
  - `CONFIG_ROOTURL` → `ROOTURL` (обязателен). Пример: `http://localhost:8088` или публичный домен.
  - `TIMEZONE` (UI) — часовой пояс инстанса.
- Email (`group: Email`):
  - `CONFIG_EMAILS_ENABLED` → `EMAILS_ENABLED` (значения: `Enabled`/`Disabled`).
  - `CONFIG_EMAILS_PROVIDER` → `EMAILS_PROVIDER` (`Sendgrid`/`Mailgun`/`Postmark`/`SMTP`).
  - `CONFIG_EMAILS_FROM_EMAIL` → `EMAILS_FROMEMAIL` (адрес отправителя).
  - API ключи: `bCMS__SendGridAPIKEY` для Sendgrid, или настройте SMTP:
    - `CONFIG_EMAILS_SMTP_SERVER`, `CONFIG_EMAILS_SMTP_PORT`, `CONFIG_EMAILS_SMTP_USERNAME`, `CONFIG_EMAILS_SMTP_PASSWORD`, `CONFIG_EMAILS_SMTP_ENCRYPTION` (`None`/`SSL`/`TLS`).
  - Дополнительно: `EMAILS_FOOTER` — HTML‑футер писем.
- Файлы/S3 (`group: File Storage`):
  - `FILES_ENABLED` (UI) — включает функциональность загрузки файлов.
  - `CONFIG_AWS_S3_KEY`/`CONFIG_AWS_S3_SECRET`/`CONFIG_AWS_S3_BUCKET`.
  - `CONFIG_AWS_S3_BROWSER_ENDPOINT` и `CONFIG_AWS_S3_SERVER_ENDPOINT` (для браузера и сервера соответственно; в Docker могут отличаться).
  - `CONFIG_AWS_S3_REGION`, `CONFIG_AWS_S3_ENDPOINT_PATHSTYLE` (`Enabled` при использовании s3mock/MinIO),
  - Опц. CDN: `CONFIG_AWS_CLOUDFRONT_ENDPOINT`, пары ключей для приватного доступа.
- OAuth (`group: Authentication`):
  - Google: `AUTH_PROVIDERS_GOOGLE_KEYS_ID`, `AUTH_PROVIDERS_GOOGLE_KEYS_SECRET`; редиректы: `${ROOTURL}/login/oauth/google.php` и `${ROOTURL}/api/account/oauth-link/google.php`.
  - Microsoft: `AUTH_PROVIDERS_MICROSOFT_APP_ID`, `AUTH_PROVIDERS_MICROSOFT_KEYS_SECRET`; редиректы: `${ROOTURL}/login/oauth/microsoft.php` и `${ROOTURL}/api/account/oauth-link/microsoft.php`.
  - JWT: `CONFIG_AUTH_JWTKey` (ровно 64 символа A‑Z0‑9), `AUTH_NEXTHASH` (`sha256`/`sha512`).
- Биллинг (`group: Billing`):
  - Stripe: ключ `STRIPE_KEY`, `STRIPE_WEBHOOK_SECRET` (при необходимости).
- Телеметрия (`group: Telemetry`):
  - `TELEMETRY_MODE` (`Disabled`/`Limited`/`Standard`), `TELEMETRY_SHOW_URL`, `TELEMETRY_NOTES`.

Примечания:
- Значения, заданные через ENV, считаются валидными без валидации интерфейса и используются как дефолт при отсутствии записей в БД.
- Для отправки почты через SMTP в Dev Container всё уже настроено на Mailpit (`CONFIG_EMAILS_PROVIDER=SMTP`, `CONFIG_EMAILS_SMTP_SERVER=mailpit`, порт 1025).

## Почтовые уведомления и шаблоны

Базовый рендеринг:
- Вызов `sendEmail()` формирует HTML из шаблона и отправляет через выбранного провайдера: `src/api/notifications/email/email.php:1`.
- Выбор провайдера определяется `EMAILS_PROVIDER` (`Sendgrid`, `Mailgun`, `Postmark`, `SMTP`). Реализации: `src/common/libs/Email/*.php`.
- Отправленные письма логируются в таблицу `emailSent` через `EmailHandler::logEmail()`.

Базовый шаблон письма:
- Файл: `src/api/notifications/email/email_template.twig:1`.
- Переменные контекста: `SUBJECT`, `TEMPLATE` (опц. Twig‑включение контента), `HTML` (сырой HTML), `INSTANCE` (имя/картинка заголовка), `CONFIG`, `FOOTER`.
- Hero‑изображение вверху: выводится, если у инстанса задан файл `instances_emailHeader` и включено файловое хранилище.
- Футер: настраивается через `EMAILS_FOOTER` (HTML разрешён).

Кастомизация контента:
- Можно передавать `TEMPLATE` — путь к другому Twig‑файлу с контентом сообщения (включится `{% include TEMPLATE %}`).
- Альтернатива — `HTML|raw` (контент инлайн).
- Готовые шаблоны под события: `src/api/instances/addUser-EmailTemplate.twig`, `src/api/maintenance/*-EmailTemplate.twig`, `src/api/projects/crew/assign-EmailTemplate.twig`.

Отправка в разработке:
- В Dev Container вся исходящая почта приходит в Mailpit (`http://localhost:8083`).

## Файловое хранилище (S3) и CDN

Включение:
- Включите `FILES_ENABLED` в конфиге и заполните S3 параметры. Для разработки в Dev Container используется `adobe/s3mock` с path‑style.

Загрузка и получение:
- Браузерная загрузка идёт через выдачу временных подписей/API (см. `src/api/file/*`, `src/api/s3files/appUploader.php:1`).
- Генерация ссылок на файлы в Twig — через фильтр `|s3URL`: `src/common/libs/twigExtensions.php:1`.

CDN/CloudFront:
- Необязательный слой CDN можно указать в `AWS_CLOUDFRONT_ENDPOINT` и, при необходимости, настроить приватный доступ (пара ключей, приватный ключ в конфиге).

## Аутентификация, права и сессии

- Сессии и токены: класс `bID` управляет токенами (`web-session`, `app-v1`, `app-v2-magic-email`) и проверяет IP/прокси: `src/common/libs/Auth/main.php:1`.
- JWT (`firebase/php-jwt`) используется для обмена с мобильным приложением и magic‑link.
- Пароли: хранение с солью и алгоритмом из `AUTH_NEXTHASH` (`sha256` по умолчанию).
- OAuth: Google/Microsoft через Hybridauth (`src/login/oauth/*.php`).
- Права:
  - Серверные (`serverActions`) — роли/позиции на уровне всего сервера.
  - Инстансовые (`instanceActions`) — права в рамках выбранной «компании/инстанса».
- Переключение инстанса и выбор дефолтного инстанса происходит автоматически при логине/редиректах.

## Уведомления в системе

- Типы уведомлений и каналы определены в `src/api/notifications/notificationTypes.php:1`.
- Отправка — через функцию `notify($typeId, $userId, $instanceId, $headline, $message, $emailTemplate, $array)` из `src/api/notifications/main.php:1`.
- Каналы сейчас: Post (зарезервировано) и Email.

## API и OpenAPI

- Все API‑эндпоинты возвращают JSON и настраивают кросс‑доменные заголовки, см. `src/api/apiHead.php:1` (загрузка payload из тела в `$_POST`/`$_GET` также реализована там).
- Защищённые эндпоинты должны подключать `apiHeadSecure.php` (проверка токена/прав) — `src/api/apiHeadSecure.php:1`.
- Аннотации OpenAPI — в докблоках (`@OA\...`). Заголовочные блоки — `src/api/openApiYAMLHeaders.php:1`.
- Генерация OpenAPI спецификации (пример): `vendor/bin/openapi --output openapi.yaml src/api`.

## Миграции и данные по умолчанию

- Миграции/сиды — Phinx (`vendor/bin/phinx`). Конфиг: `phinx.php:1`.
- Сиды по умолчанию:
  - Пользователь `username` с паролем `password!` и ролью «Super‑admin»: `db/seeds/DefaultUserSeeder.php:1`.
  - Права/позиции «Administrator/Super‑admin»: `db/seeds/PositionsSeeder.php:1`.
  - Категории/группы/производители — базовые справочники: `db/seeds/AssetCategorySeeder.php:1`, `db/seeds/ManufacturersSeeder.php`.

## Разработка и отладка

- Включение DEV режима: `DEV_MODE=true` (детальные ошибки, Twig без кэша, дополнительные проверки).
- Статические ресурсы и UI: шаблоны Twig в `src/*.twig`, компоненты AdminLTE в `src/static-assets`.
- Twig фильтры/функции доступны из `src/common/libs/twigExtensions.php:1` (например, `money`, `s3URL`, `timeago`).
- Почта в dev: Mailpit на `http://localhost:8083`.
- Отладка API: все ответы проходят через `finish()` (см. `src/api/apiHead.php:1`).

## Безопасность и продакшен‑настройки

- Обязательно задайте корректный `ROOTURL`, `AUTH_JWTKey`, отключите `DEV_MODE`.
- Настройте реальную почту (провайдер/SMTP) и домен отправителя (SPF/DKIM/DMARC).
- CSP: строгие заголовки собираются в `head.php` и отдаются через `header('Content-Security-Policy: ...')`.
- Прокси/real IP: в проверке токена учитываются `CF-Connecting-IP`/`X-Forwarded-For`.
- Sentry: укажите DSN в `ERRORS_PROVIDERS_SENTRY` для отправки ошибок в продакшене.

## Обновление и обслуживание

- Пересоберите контейнер после обновления зависимостей/кода: `docker compose build --no-cache && docker compose up -d`.
- Выполните миграции при обновлениях схемы: `php vendor/bin/phinx migrate -e production`.
- Резервные копии: снимайте дампы БД и файлового хранилища (если используете локальное/S3‑совместимое).

## Частые проблемы и диагностика

- Не поднимается БД/приложение: проверьте `.env` (пароль root), переменные `DB_*` в `docker-compose.yml` и логи контейнеров (`docker compose logs`).
- Повторно появляется форма конфигурации: таблица `config` пуста или часть значений невалидна — заполните форму или задайте ключи через ENV (`CONFIG_*`).
- Письма не уходят: включите `EMAILS_ENABLED=Enabled`, проверьте провайдера/ключи/SMTP; в dev проверьте Mailpit.
- Файлы/S3 не работают: проверьте `FILES_ENABLED`, путь/эндпоинты S3 и `path-style` режим для эмуляторов.
- Проблемы с OAuth: проверьте redirect URI в консолях Google/Microsoft — см. раздел конфигурации.

Примечание: в базовом шаблоне письма блок hero зависит от наличия переменных инстанса и включенного хранилища. Если вы кастомизируете контекст, убедитесь, что передаёте необходимые значения (`INSTANCE` и включённые файлы), иначе условие не сработает.

## Лицензия

AGPL‑3.0‑only (см. `LICENSE`). Любые модификации и сетевое разворачивание подразумевают публикацию исходного кода модификаций согласно условиям AGPL.

## Глубокий справочник функций и сценариев использования

Ниже приведён детальный справочник по ключевым подсистемам AdamRMS. Каждый раздел раскрывает сущности, рабочих акторов, этапы внедрения и варианты интеграции. Все примеры ориентированы на эксплуатацию в production-среде, но могут быть адаптированы для тестовых стендов.

### Управление инстансами и многоарендность

Механизм инстансов позволяет изолировать бизнес-единицы внутри одной установки AdamRMS. Каждый инстанс получает собственные настройки, набор пользователей и политику безопасности, что делает систему пригодной для MSP и крупных компаний с филиалами.

**Ключевые объекты и сущности**
- Инстанс — логическое пространство с отдельной конфигурацией и метаданными.
- Глобальный администратор сервера, управляющий созданием и архивированием инстансов.
- Профиль инстанса с названием, брендингом, контактами и рабочим часовым поясом.
- Статусы инстанса: активный, архивированный, замороженный, тестовый.
- Параметры квотирования по пользователям, активам и проектам.
- Журнал изменений конфигурации с фиксацией оператора и временной метки.

**Основные сценарии**
- Создайте инстанс через Server → Instances, задав базовые параметры и ответственных администраторов.
- Используйте шаблоны конфигураций, чтобы ускорить развёртывание новых инстансов с типовыми настройками.
- Добавляйте участников в инстанс через модуль Invite, выдавая роль в несколько кликов.
- Замораживайте инстанс при длительном простое, чтобы скрыть его из списков и приостановить уведомления.

**Продвинутые сценарии**
- Настройте политики квотирования, ограничивающие создание активов и проектов на уровне инстанса.
- Создавайте временные инстансы для выставок и удаляйте их после завершения мероприятий.
- Используйте API `/api/instances/manage.php` для автоматического создания инстансов из внешней CRM.
- Поддерживайте разные часовые пояса и форматы дат для международных подразделений.

**Автоматизация и интеграции**
- Подключайте вебхуки на события создания или архивирования инстанса для синхронизации с биллинговой системой.
- Сценарии в Zapier/Make могут вызывать защищённые API для пополнения инстанса пользователями из HR-систем.
- Используйте SSO с Google или Azure AD, чтобы автоматически назначать сотрудников в нужный инстанс.
- Интегрируйте аналитические витрины, выгружая статистику по инстансам в Data Warehouse через Telemetry API.

**Тонкая настройка и отладка**
- Журналируйте все операции создания/архивирования через `analyticsEvents`, чтобы отслеживать SLA.
- Проверяйте целостность конфигурации инстанса с помощью `server/diagnostics.php`, анализируя предупреждения.
- Используйте режим Dev Mode для тестовых инстансов, чтобы отключить реальные интеграции и ускорить отладку.
- Регулярно пересматривайте права глобальных администраторов, проверяя аудит раз в квартал.


### Управление пользователями и профилями

Модуль пользователей охватывает жизненный цикл учётной записи: приглашения, активацию, управление ролями, синхронизацию с OAuth и удаление. Карточка пользователя отображает участие в проектах и историю действий.

**Ключевые объекты и сущности**
- Профиль пользователя с личными данными и настройками уведомлений.
- Приглашения и pending-записи для отложенной активации.
- Роли уровня сервера и инстанса, управляющие правами.
- История входов, журнал устройств и выданных токенов.
- OAuth-связки с Google, Microsoft, другими IdP.
- Логи отписок от email и пользовательские предпочтения по коммуникациям.

**Основные сценарии**
- Пригласите сотрудника в систему, указав email и роль, и отправьте магическую ссылку для активации.
- Обновите личные данные через профиль, включая контакты, должность и фотографию.
- Назначайте роли уровня сервера (например, Support) и инстанса (например, Inventory Manager).
- Сбрасывайте пароли через админку или сам сервис восстановления с подтверждением email.

**Продвинутые сценарии**
- Настройте обязательную MFA для ролей с повышенными правами, требуя TOTP при каждом входе.
- Свяжите аккаунт с Google Workspace через OAuth для бесшовного SSO и автоматического provisioning.
- Используйте API `/api/account/updateProfile.php` для интеграции с HR-порталом.
- Поддерживайте кастомные атрибуты профиля (например, номер удостоверения) через расширение схемы.

**Автоматизация и интеграции**
- Запускайте SCIM-подобные синхронизации через API, создавая и деактивируя учётки по данным из HRIS.
- Интегрируйте webhook `user.invited` с корпоративным чат-ботом, уведомляющим наставников.
- Рассылайте Welcome-пакеты через Email-провайдер, используя данные профиля для персонализации.
- Настройте автоматический offboarding: деактивация, отзыв токенов, архивация данных и уведомление IT.

**Тонкая настройка и отладка**
- Просматривайте журналы входов и событий безопасности в Server → Logs для расследования инцидентов.
- Используйте Sentry breadcrumbs с тегом `userId`, чтобы связывать ошибки с конкретными пользователями.
- Регулярно выгружайте CSV пользователей и сравнивайте с HR-реестрами для контроля актуальности.
- Автоматизируйте очистку устаревших приглашений, используя cron-скрипт и API `deleteInvite`.


### Матрица прав доступа и разрешений

Система разрешений AdamRMS строится на двухуровневой матрице: серверные и инстансовые права. Она покрывает сценарии от глобальных администраторов до узкоспециализированных операторов.

**Ключевые объекты и сущности**
- Набор серверных прав `SERVER:*`, управляющих глобальными функциями.
- Инстансовые права `INSTANCE:*`, определяющие доступ внутри конкретного пространства.
- Предустановленные роли (Owner, Technician, Guest) с типовыми наборами прав.
- Кастомные роли, собранные из отдельных разрешений.
- UI-редактор прав с подсказками и поиском по ключевым словам.
- Аудит изменений ролей и прав с записью пользователя и временной метки.

**Основные сценарии**
- Назначайте предустановленные роли при добавлении пользователя в инстанс, чтобы быстро выдать доступ.
- Используйте страницу Server → Permissions для просмотра всех доступных разрешений и их описаний.
- Создавайте кастомные роли, комбинируя права по принципу минимально необходимого доступа.
- Делегируйте управление правами локальным администраторам, оставив за собой аудит изменений.

**Продвинутые сценарии**
- Настройте раздельное право на загрузку и просмотр файлов, чтобы контролировать доступ к конфиденциальным документам.
- Применяйте условные роли, выдавая дополнительные разрешения только во время активных проектов.
- Интегрируйте права с внешним IAM, синхронизируя группы через SCIM или Azure AD.
- Документируйте матрицу прав в Confluence/Notion, связывая её с политиками безопасности компании.

**Автоматизация и интеграции**
- Связывайте назначение ролей с рабочими процессами HR: при изменении должности обновляйте права через API.
- Используйте Terraform-подобные декларации YAML/JSON для описания ролей и автоматической синхронизации.
- Включайте уведомления в Slack, когда администратор изменил критическую роль или выдал повышенные права.
- Автоматизируйте отзыв прав у неактивных пользователей, анализируя журнал входов и метрики активности.

**Тонкая настройка и отладка**
- Проверяйте активные права пользователя через вкладку Debug в профиле, где отображаются разрешения в реальном времени.
- Используйте логирование `$AUTH->instancePermissionCheck` в Dev Mode для поиска проблем с доступом.
- Сравнивайте фактические права с ожидаемыми, используя SQL-запросы к таблицам `instancePermissions`.
- Используйте Sentry tags `permission` для фильтрации ошибок, связанных с отказом в доступе.


### Каталог активов и учёт оборудования

Каталог активов — центральный модуль, в котором хранится информация об оборудовании, расходниках и комплектах. Поддерживаются индивидуальные карточки, уникальные идентификаторы, привязка к проектам и история операций.

**Ключевые объекты и сущности**
- Карточка актива с инвентарным номером, серийным номером и пользовательскими полями.
- Типы активов, определяющие набор характеристик и связанных чек-листов.
- Статусы готовности: доступен, зарезервирован, в ремонте, списан.
- История перемещений и событий обслуживания.
- Фотографии и вложения, показывающие состояние оборудования.
- Поле Ownership для учёта арендуемых и партнёрских активов.

**Основные сценарии**
- Добавляйте новые активы через Inventory → Add Asset, указывая все ключевые атрибуты и категории.
- Используйте массовый импорт CSV/Excel для загрузки тысяч активов с первоначальными остатками.
- Фильтруйте каталог по типам, статусу и местоположению, чтобы быстро находить нужное оборудование.
- Закрепляйте актив за ответственным сотрудником или проектом для прозрачности владения.

**Продвинутые сценарии**
- Определяйте пользовательские поля (например, напряжение, вес) через Config → Custom Fields.
- Привязывайте гарантийные талоны и сертификаты к активу для последующей проверки.
- Используйте цепочку подтверждений при списании дорогостоящего оборудования.
- Создавайте отчёты по оборачиваемости активов, экспортируя данные в BI-платформы.

**Автоматизация и интеграции**
- Синхронизируйте каталог с ERP-системой, обмениваясь данными через API `/api/assets/*.php`.
- Настройте автоматическую генерацию QR-кодов при добавлении нового актива.
- Интегрируйте датчики IoT, передающие состояние оборудования и обновляющие карточку актива.
- Используйте webhook `asset.updated` для уведомления команд о смене статуса важного оборудования.

**Тонкая настройка и отладка**
- Включайте режим истории изменений, чтобы видеть, кто изменял поля карточки и когда.
- Используйте Phinx миграции для добавления новых справочных таблиц, связанных с активами.
- Проверяйте корректность пользовательских полей, валидируя их через Config и тестовые данные.
- Сопоставляйте данные каталога с физической инвентаризацией, используя отчёты расхождений.


### Категории, типы и спецификации оборудования

Типы активов задают структуру карточек, описывают набор характеристик и правила отображения. Именно через типы настраиваются чек-листы, сервисные интервалы и шаблоны комплектов.

**Ключевые объекты и сущности**
- Категории верхнего уровня для группировки похожих активов.
- Типы, содержащие список обязательных и необязательных полей.
- Связанные комплекты, которые доступны только для выбранного типа.
- Шаблоны сервисных работ с интервалами по времени и пробегу.
- Профили отображения в каталоге и печатных отчётах.
- Справочники значений (например, производители, классы защиты).

**Основные сценарии**
- Создайте тип через Inventory → Types, задав поля и допустимые значения.
- Привяжите к типу чек-лист при выдаче, чтобы не забывать о проверках перед сдачей оборудования.
- Установите интервалы обслуживания, чтобы система предлагала плановые визиты сервиса.
- Используйте иконки и цвета, чтобы визуально различать категории в каталоге.

**Продвинутые сценарии**
- Настраивайте матрицу допустимых локаций для каждого типа, чтобы контролировать перемещения.
- Связывайте типы с требованиями по сертификации и отслеживайте сроки их обновления.
- Создавайте подтипы для разных комплектаций оборудования внутри одной категории.
- Экспортируйте конфигурацию типов в YAML, чтобы версионировать её вместе с кодом.

**Автоматизация и интеграции**
- Используйте API для массового обновления характеристик при смене классификатора.
- Генерируйте спецификации в PDF на основе Twig-шаблонов, подставляя данные типа.
- Подключайте внешние каталоги (например, ETIM), синхронизируя справочники значений.
- Автоматизируйте создание комплектов при появлении нового типа через webhook `type.created`.

**Тонкая настройка и отладка**
- Проверяйте влияние новых полей на существующие отчёты и формы приёмки.
- Используйте staging-инстанс для тестирования изменения структуры типов перед внедрением.
- Следите за локализацией названий и единиц измерения в многоязычных инсталляциях.
- Документируйте изменения в типах, фиксируя причину и ожидаемый эффект в аудит-логе.


### Складские локации, зоны и логистика

Подсистема локаций описывает физические места хранения: склады, комнаты, кейсы и транспорт. Она помогает отслеживать перемещения активов и визуализировать размещение оборудования.

**Ключевые объекты и сущности**
- Склад — базовый объект с адресом, геометкой и типом (постоянный, мобильный).
- Зоны внутри склада: стеллажи, ячейки, кейсы, с возможностью вложенности.
- Связка актив → локация с историей перемещений и отметками времени.
- Статусы локаций (активна, недоступна, в обслуживании).
- Планировщик перемещений с подтверждением ответственного.
- Отчёты по заполненности и оборачиваемости локаций.

**Основные сценарии**
- Создайте структуру склада, добавив зоны и вложенные ячейки для детальной адресации.
- Перемещайте активы между локациями вручную или через массовые операции со сканером.
- Используйте отчёт по наличию, чтобы увидеть текущий состав каждой локации.
- Назначайте ответственных за зоны, чтобы отслеживать SLA возврата оборудования.

**Продвинутые сценарии**
- Включайте геолокацию и отображайте склады на карте для распределённых команд.
- Создавайте шаблоны погрузочных листов для экспедиций и выставок.
- Интегрируйте данные о локациях с системами доступа для контроля открывания дверей.
- Настраивайте автоматические проверки заполненности и уведомления о перегрузе.

**Автоматизация и интеграции**
- Подключайте RFID-шлюзы и обновляйте локацию актива при прохождении через ворота.
- Используйте API `/api/assets/move.php` для интеграции с транспортной логистикой.
- Отправляйте push-уведомления кладовщикам при поступлении срочных перемещений.
- Связывайте локации с внешними системами WMS для обмена остатками.

**Тонкая настройка и отладка**
- Проводите регулярные инвентаризации, сверяя фактические и системные локации.
- Используйте отчёт по расхождениям, чтобы анализировать частые ошибки перемещений.
- Оптимизируйте структуру зон, избегая слишком глубокой вложенности для быстрого поиска.
- Логируйте автоматические перемещения, чтобы разбирать спорные ситуации с аутсорсерами.


### Комплекты и наборы оборудования

Комплекты позволяют объединять активы в преднастроенные наборы для проектов, мероприятий или аренды. Каждый комплект может включать обязательные и опциональные позиции, а также инструкции по сборке.

**Ключевые объекты и сущности**
- Карточка комплекта с названием, описанием и фотографиями.
- Состав комплекта: обязательные и дополнительные активы с количественными нормами.
- Связанные типы проектов, для которых комплект рекомендован.
- Чек-листы сборки и возврата с автоматическим контролем.
- Шаблоны резервирования, ускоряющие выдачу комплектов на проекты.
- История использования комплектов и статистика востребованности.

**Основные сценарии**
- Создайте комплект, добавив обязательные активы и указав минимальные остатки.
- Резервируйте комплект целиком для проекта, чтобы автоматически забронировать все элементы.
- Используйте чек-листы при выдаче и возврате, чтобы контролировать комплектацию.
- Просматривайте историю использования, чтобы планировать закупки и обновление комплекта.

**Продвинутые сценарии**
- Добавляйте опциональные позиции, предлагая менеджеру выбор дополнительных элементов.
- Создавайте композитные комплекты, состоящие из нескольких вложенных наборов.
- Применяйте динамическую замену активов при недоступности конкретной единицы.
- Используйте рекомендованные комплекты в CRM при подготовке коммерческих предложений.

**Автоматизация и интеграции**
- Настройте автоподбор комплектов по типу проекта и количеству участников.
- Интегрируйте комплекты с e-commerce витриной, позволяя клиентам бронировать их онлайн.
- Автоматически уведомляйте кладовщиков о необходимости сборки комплекта через Task API.
- Синхронизируйте состав комплектов с внешними системами, экспортируя BOM (Bill of Materials).

**Тонкая настройка и отладка**
- Проверяйте корректность комплектов на staging, имитируя выдачу и возврат.
- Анализируйте статистику недостач по комплектам, оптимизируя обязательные позиции.
- Документируйте инструкции по сборке, обновляя их через Twig-шаблоны.
- Настройте уведомления при снижении остатка ниже минимального количества комплектов.


### Учёт расходников и материалов

Расходники учитываются партиями, поддерживают списание, списание по нормам и автоматический пересчёт остатков. Модуль полезен для кабелей, ламп, запчастей и иных быстро расходуемых материалов.

**Ключевые объекты и сущности**
- Партия расходника с датой поступления и сроком годности.
- Нормы списания для проектов и сервисных работ.
- Складские остатки по локациям и ответственным.
- Журнал списаний с указанием причины и связанного документа.
- Уведомления о критическом остатке и сроках годности.
- Отчёты по потреблению и прогнозу запасов.

**Основные сценарии**
- Вносите поступления расходников с указанием партии и поставщика.
- Списывайте материалы на проекты по норме или фактическому расходу.
- Перераспределяйте остатки между складами при изменении приоритетов.
- Контролируйте срок годности и вовремя утилизируйте просроченные партии.

**Продвинутые сценарии**
- Используйте серийные номера для дорогих расходников с уникальными идентификаторами.
- Настраивайте автоматические нормы списания, привязанные к типу проекта и длительности.
- Отслеживайте расход по ответственным, стимулируя бережное отношение к материалам.
- Интегрируйте заказные позиции с финансовым учётом для контроля бюджета.

**Автоматизация и интеграции**
- Подключите сканеры штрихкодов для быстрого списания расходников со склада.
- Используйте API `/api/stock/consume.php` для интеграции с производственными системами.
- Настройте автозаявки поставщикам при достижении минимального остатка.
- Выгружайте прогнозы расхода в Excel или BI-платформы для планирования закупок.

**Тонкая настройка и отладка**
- Проводите сверку складов, сопоставляя фактические и системные остатки.
- Анализируйте причины списания по категориям, оптимизируя нормативы.
- Проверяйте корректность учёта НДС и стоимости при списаниях.
- Документируйте процедуры работы с расходниками и проводите инструктаж персонала.


### Сканирование штрихкодов и QR/NFC

Система поддерживает генерацию и сканирование штрихкодов, QR-кодов и NFC-меток для ускорения операций. Модуль интегрируется с мобильными приложениями и внешними сканерами.

**Ключевые объекты и сущности**
- Генераторы штрихкодов и QR с настройкой форматов и размеров.
- Связь идентификатора с карточкой актива или локации.
- Мобильное приложение или веб-интерфейс с камерой для сканирования.
- Логи сканирования с координатами и пользователем.
- Поддержка NFC-меток для оборудования без визуального доступа.
- Шаблоны печати этикеток через интеграцию с принтерами.

**Основные сценарии**
- Печатайте этикетки при добавлении нового актива из карточки или массового списка.
- Используйте мобильное приложение, чтобы выдавать и возвращать оборудование при помощи сканера.
- Закрепляйте NFC-метки на оборудовании в цехах, где штрихкод сложно отсканировать.
- Просматривайте историю сканирований, чтобы определить ответственных за последнее перемещение.

**Продвинутые сценарии**
- Реализуйте двойное сканирование для подтверждения комплектов и исключения ошибок.
- Используйте шифрованные QR-коды для доступа к технической документации.
- Настройте динамические URL, которые ведут на актуальные инструкции в зависимости от статуса актива.
- Интегрируйте сканеры с кассовыми системами для учёта аренды.

**Автоматизация и интеграции**
- Подключайте REST API, чтобы внешние сканеры могли списывать и перемещать активы в реальном времени.
- Используйте WebSocket-каналы для отображения результатов сканирования на диспетчерском табло.
- Интегрируйте принтеры Zebra или Brother для массовой печати этикеток.
- Включайте push-уведомления при сканировании критически важного оборудования.

**Тонкая настройка и отладка**
- Проверяйте корректность шрифтов и форматов штрихкодов перед крупными партиями печати.
- Тестируйте NFC-метки на совместимость с используемыми устройствами и материалами корпуса.
- Анализируйте лог сканирования, чтобы выявить ошибки пользователей или проблемы оборудования.
- Создайте чек-листы по обслуживанию сканеров и обновлению прошивок.


### Планирование проверок и контроль качества

Модуль плановых проверок позволяет формировать графики инспекций оборудования и контролировать выполнение чек-листов.

**Ключевые объекты и сущности**
- Плановая проверка с датой, ответственным и списком активов.
- Чек-листы контроля качества с обязательными пунктами.
- Уведомления исполнителям о приближении сроков.
- Журнал результатов с фотографиями и комментариями.
- Отчёты по просроченным и выполненным проверкам.
- Интеграция с сервисными заявками для автоматического создания задач.

**Основные сценарии**
- Создайте план проверки для каждой категории оборудования с указанной периодичностью.
- Назначайте исполнителей и отправляйте им уведомления с чек-листом.
- Фиксируйте результаты и прикладывайте фото для подтверждения состояния.
- Используйте отчёт по просроченным проверкам для планирования ресурсов.

**Продвинутые сценарии**
- Настройте дифференцированную периодичность проверок в зависимости от интенсивности использования.
- Используйте мобильное приложение, чтобы проводить проверку офлайн и синхронизировать результаты позже.
- Включайте шаги по тестированию безопасности и соответствия отраслевым стандартам.
- Создавайте автоматические сервисные заявки при обнаружении критических замечаний.

**Автоматизация и интеграции**
- Выгружайте расписание проверок в корпоративный календарь через iCal или Exchange.
- Используйте API для массового обновления статусов проверок из внешних систем контроля качества.
- Интегрируйте IoT-датчики, которые инициируют проверку при превышении пороговых значений.
- Настройте отчёты в Power BI или Looker с показателями выполнения проверок.

**Тонкая настройка и отладка**
- Проверяйте чек-листы на полноту и актуальность перед запуском сезонных проверок.
- Используйте тестовые сценарии, чтобы убедиться в корректности уведомлений и напоминаний.
- Документируйте изменения в графике проверок и храните историю версий.
- Анализируйте время выполнения проверок, оптимизируя нагрузку на сотрудников.


### Управление сервисными заявками и ремонтом

Сервисные заявки позволяют фиксировать неисправности, назначать исполнителей, контролировать сроки и затраты.

**Ключевые объекты и сущности**
- Заявка на обслуживание с описанием проблемы и приоритетом.
- Очередь и статусы заявки (новая, в работе, ожидание, закрыта).
- Назначенный техник и группа обслуживания.
- Журнал действий по заявке: комментарии, вложения, потраченные материалы.
- Привязка к активу, проекту и локации.
- Отчёты по SLA и повторяемости неисправностей.

**Основные сценарии**
- Создавайте заявки вручную или через фронт для сотрудников, описывая проблему.
- Назначайте ответственных техников и отслеживайте статус выполнения.
- Записывайте фактическое время и затраченные материалы для учёта расходов.
- Закрывайте заявку с указанием решения и рекомендаций.

**Продвинутые сценарии**
- Используйте приоритеты и правила эскалации для критически важных активов.
- Связывайте повторяющиеся заявки, чтобы выявлять системные проблемы.
- Интегрируйте заявки с CMMS или Jira Service Management.
- Анализируйте статистику неисправностей по типам и локациям.

**Автоматизация и интеграции**
- Приём заявок через email с автоматическим созданием карточек.
- Вебхуки для уведомления подрядчиков о новых задачах.
- Интеграция с мобильными приложениями для фотоотчётов и чек-листов.
- Экспорт данных в бухгалтерию для учёта затрат на ремонт.

**Тонкая настройка и отладка**
- Анализируйте SLA, сравнивая плановое и фактическое время реакции.
- Проводите ревью закрытых заявок для повышения качества обслуживания.
- Настройте шаблоны заявок для типовых неисправностей.
- Используйте тестовую среду для проверки новых маршрутов согласования.


### Проекты, мероприятия и бронирования

Проектный модуль объединяет ресурсы, команду и расписание. Проекты могут быть внутренними, клиентскими или арендными.

**Ключевые объекты и сущности**
- Карточка проекта с временными рамками, заказчиком и статусом.
- Ресурсный план: активы, комплекты, помещения, персонал.
- Финансовые параметры: бюджет, ставки, фактические затраты.
- Коммуникации: комментарии, файлы, связанные документы.
- Статусы проекта (планирование, подтверждён, в работе, завершён).
- Отчёты по занятости ресурсов и прибыльности.

**Основные сценарии**
- Создайте проект, указав заказчика, даты и требуемые ресурсы.
- Резервируйте активы и комплекты под проект, контролируя пересечения по времени.
- Назначайте команду проекта с ролями и зонами ответственности.
- Фиксируйте фактическое выполнение и закрывайте проект после сдачи работ.

**Продвинутые сценарии**
- Используйте шаблоны проектов для типовых мероприятий.
- Настройте зависимости и критический путь, чтобы видеть риски срыва сроков.
- Ведите финансовый учёт с расчётом маржинальности и распределением расходов.
- Синхронизируйте проект с внешними календарями и таск-трекерами.

**Автоматизация и интеграции**
- Подключайте CRM, чтобы автоматически создавать проект после подписания сделки.
- Используйте API для синхронизации расписаний с внешними системами бронирования.
- Настройте уведомления клиентам об изменениях в статусе проекта.
- Экспортируйте таймлайны в PDF или презентации для согласования.

**Тонкая настройка и отладка**
- Проводите пост-проектный анализ, сравнивая план и факт по ресурсам.
- Используйте отчёты по загрузке команды, чтобы избежать перегрузок.
- Тестируйте новые шаблоны проектов в пилотных командах.
- Документируйте уроки и лучшую практику в карточке проекта.


### Ресурсное планирование и календарь

Календарь ресурсов визуализирует занятость активов, комплектов и персонала во времени. Он помогает избегать конфликтов и оптимизировать загрузку.

**Ключевые объекты и сущности**
- Календарные виды: день, неделя, месяц, год.
- Ресурсные линии: активы, комплекты, помещения, сотрудники.
- Бронирования с ссылкой на проекты и статусы подтверждения.
- Конфликты и овербукинг с рекомендациями по решению.
- Фильтры по инстансу, локации, типу ресурса.
- Экспорт iCal и подписки для внешних календарей.

**Основные сценарии**
- Просматривайте занятость ресурсов в календаре, чтобы оценить доступность.
- Перетаскивайте бронирования мышью для быстрых изменений расписания.
- Фильтруйте по типу ресурса, чтобы работать только с нужными активами.
- Создавайте новые бронирования прямо из календаря, выбирая свободные слоты.

**Продвинутые сценарии**
- Используйте цветовую кодировку для разных типов проектов.
- Настройте уровни подтверждения, где менеджер ресурсов утверждает каждый запрос.
- Анализируйте статистику загрузки по неделям и месяцам.
- Связывайте календарь с ограничениями по транспортировке и обслуживанию.

**Автоматизация и интеграции**
- Синхронизируйте календарь с Google Calendar или Outlook через iCal.
- Используйте API для интеграции с корпоративными системами планирования смен.
- Настройте уведомления в мессенджерах при переносе ключевых событий.
- Экспортируйте расписание в формате CSV для офлайн-анализов.

**Тонкая настройка и отладка**
- Проверяйте корректность часовых поясов при международных проектах.
- Тестируйте режимы фильтрации и поиска, чтобы убедиться в быстродействии.
- Используйте анонимизацию при демонстрации данных клиентам.
- Оптимизируйте права доступа, скрывая конфиденциальные бронирования.

### Командные роли и распределение задач

Командный модуль описывает оргструктуру проектов: роли, ответственных и задачи. Он позволяет прозрачно распределять обязанности и отслеживать загрузку каждого участника.

**Ключевые объекты и сущности**
- Ролевая матрица проекта с описанием обязанностей.
- Карточка участника с контактами, навыками и загрузкой.
- Задачи проекта с приоритетом и дедлайном.
- Шаблоны команд для типовых мероприятий.
- Оповещения о назначении и изменении задач.
- Отчёты по эффективности и исполнению задач.

**Основные сценарии**
- Создавайте роли проекта и назначайте на них сотрудников с учётом компетенций.
- Разбивайте работу на задачи, указывая сроки и описание результатов.
- Используйте доску задач для контроля статусов выполнения.
- Подтверждайте завершение задач и фиксируйте фактическое время работы.

**Продвинутые сценарии**
- Настраивайте иерархию ролей с заместителями и резервными исполнителями.
- Связывайте задачи с активами или сервисными заявками, чтобы видеть зависимость.
- Используйте метки навыков, чтобы подбирать исполнителей по опыту.
- Формируйте матрицу RACI для ответственных, согласующих и информируемых.

**Автоматизация и интеграции**
- Интегрируйте задачи с Jira, Asana или Trello через API и вебхуки.
- Настройте уведомления в Slack или Teams при назначении новых задач.
- Экспортируйте расписание задач в календарь, чтобы учитывать занятость.
- Используйте отчёты API для синхронизации с системой KPI и оценки персонала.

**Тонкая настройка и отладка**
- Проверяйте корректность уведомлений при массовом назначении задач.
- Проводите ретроспективы и анализируйте отклонения по срокам.
- Актуализируйте шаблоны команд после каждого крупного проекта.
- Документируйте полномочия каждой роли в базе знаний.


### Финансовый учёт и бюджеты проектов

Финансовый модуль AdamRMS поддерживает бюджеты, фактические расходы, ставки и автоматический расчёт прибыльности проектов.

**Ключевые объекты и сущности**
- Бюджет проекта с разбивкой по статьям расходов и доходов.
- Ставки оборудования и персонала для калькуляции.
- Заявки на расходование средств и их утверждение.
- Финансовые отчёты по маржинальности и возврату инвестиций.
- Интеграция с бухгалтерскими системами через CSV и API.
- Журнал корректировок и комментариев к финансовым операциям.

**Основные сценарии**
- Задавайте бюджет проекта и фиксируйте ожидаемые статьи расходов.
- Применяйте ставки аренды оборудования и работы персонала для расчёта сметы.
- Отмечайте фактические затраты по мере поступления счетов и накладных.
- Сравнивайте план и факт на дашборде маржинальности.

**Продвинутые сценарии**
- Используйте несколько валют для международных проектов.
- Настраивайте многоуровневое согласование заявок на крупные расходы.
- Связывайте финансовые данные с контрактами и актами выполненных работ.
- Анализируйте кумулятивные доходы/расходы по портфелю проектов.

**Автоматизация и интеграции**
- Экспортируйте данные в бухгалтерию (1С, SAP) через CSV или API.
- Интегрируйте Stripe или другие платёжные системы для выставления счетов.
- Используйте вебхуки, чтобы уведомлять финансовый отдел о превышении бюджета.
- Публикуйте финансовые метрики в BI-панелях для руководства.

**Тонкая настройка и отладка**
- Проверяйте корректность курсов валют и их обновление.
- Верифицируйте права доступа, чтобы ограничить просмотр финансовых данных.
- Проводите тестовые расчёты на копии проекта перед релизом новых ставок.
- Храните документы-основания в защищённых файловых структурах.


### CRM и управление клиентами

CRM-блок помогает вести клиентские аккаунты, контакты, договоры и историю взаимодействий. Он связывает клиентов с проектами, финансовыми документами и уведомлениями.

**Ключевые объекты и сущности**
- Карточка клиента с реквизитами и сегментацией.
- Контакты и роли (менеджер, бухгалтер, техдиректор).
- История коммуникаций: звонки, письма, встречи.
- Связанные проекты, договоры и счета.
- Поля для кредитных лимитов и условий оплаты.
- Отчёты по активности и статусу сделок.

**Основные сценарии**
- Создавайте клиентов и добавляйте ключевых контактов.
- Привязывайте проекты к клиенту, чтобы видеть портфель заказов.
- Фиксируйте результаты переговоров и договорённости в журнале взаимодействий.
- Контролируйте кредитный лимит и сроки оплаты по каждому клиенту.

**Продвинутые сценарии**
- Используйте сегментацию для маркетинговых рассылок.
- Храните кастомные поля (например, отрасль, размер компании).
- Поддерживайте несколько договоров и адресов доставки для одного клиента.
- Интегрируйте CRM с внешними системами лидогенерации.

**Автоматизация и интеграции**
- Синхронизируйте клиентов с ERP или бухгалтерией для единой базы.
- Используйте вебхуки `client.updated` для обновления CRM-дашбордов.
- Автоматически создавайте задачи менеджеру при новых запросах.
- Экспортируйте клиентские данные в маркетинговые платформы.

**Тонкая настройка и отладка**
- Проверяйте корректность прав на просмотр коммерчески чувствительных данных.
- Актуализируйте шаблоны карточек клиента при изменении бизнес-процессов.
- Проводите регулярный аудит устаревших контактов и объединяйте дубликаты.
- Соблюдайте требования GDPR и локальных законов о защите данных.


### Площадки мероприятий и маршруты

Модуль площадок описывает внешние локации: арендуемые площадки, маршруты доставки и специфику доступа.

**Ключевые объекты и сущности**
- Карточка площадки с адресом, координатами и контактами.
- Технические требования: электричество, грузовые лифты, ограничения по шуму.
- График доступности и окна монтажа/демонтажа.
- Маршруты доставки с точками и временем в пути.
- Документы площадки: схемы залов, инструкции безопасности.
- История мероприятий на площадке и отзывов команды.

**Основные сценарии**
- Создавайте площадки и привязывайте их к проектам.
- Указывайте окна доступа, чтобы планировать логистику.
- Прикрепляйте схемы и правила, чтобы команда была готова.
- Вносите маршруты доставки и точки выгрузки.

**Продвинутые сценарии**
- Храните требования по безопасности и согласованиям.
- Отслеживайте историю инцидентов и lessons learned.
- Настраивайте шаблонные маршруты для повторяющихся площадок.
- Используйте оценки команды, чтобы ранжировать площадки.

**Автоматизация и интеграции**
- Экспортируйте адреса в навигационные системы и приложения такси.
- Интегрируйте с инструментами логистики для расчёта времени в пути.
- Отправляйте уведомления команде с координатами и контактами.
- Синхронизируйте данные площадок с внешними каталогами событий.

**Тонкая настройка и отладка**
- Проверяйте точность координат и адресов перед выездом.
- Документируйте особые условия доступа и пропусков.
- Обновляйте контактные данные менеджеров площадок.
- Храните историю версий документов и схем.


### Документы, договоры и файловое хранилище

Файловая подсистема хранит договора, акты, инструкции и медиа. Она поддерживает S3, контроль доступа и версии.

**Ключевые объекты и сущности**
- Библиотека файлов с категорией и тегами.
- Версионность документов и журнал изменений.
- Права доступа на просмотр, скачивание и загрузку.
- Интеграция с внешними S3/MinIO хранилищами.
- Печатные шаблоны на Twig для генерации PDF.
- Антивирусные проверки и контроль типов файлов.

**Основные сценарии**
- Загружайте договоры и акты в карточки проектов и клиентов.
- Используйте теги для быстрого поиска нужных документов.
- Настраивайте права, чтобы конфиденциальные файлы видели только ответственные.
- Отслеживайте версии и сравнивайте изменения.

**Продвинутые сценарии**
- Подключайте сторонние CDN для ускорения выдачи файлов.
- Используйте цифровые подписи и храните сертификаты.
- Генерируйте документы по шаблону, подставляя данные проекта.
- Включайте хранение больших медиафайлов с предпросмотром.

**Автоматизация и интеграции**
- Интегрируйте с DocuSign/SignNow для электронных подписей.
- Используйте API `/api/file/index.php` для выдачи временных ссылок.
- Настройте lifecycle-политику S3 для архивирования старых файлов.
- Подключайте антивирусные сканеры через очереди и вебхуки.

**Тонкая настройка и отладка**
- Проверяйте размеры и лимиты загрузки на стороне PHP и веб-сервера.
- Контролируйте использование дискового пространства и стоимость хранения.
- Тестируйте восстановление файлов из резервных копий.
- Документируйте политику классификации документов.


### Почтовые уведомления и рассылки

Почтовый движок обеспечивает транзакционные уведомления, маркетинговые рассылки и интеграцию с SMTP/Sendgrid/Mailgun.

**Ключевые объекты и сущности**
- Очередь отправки писем и таблица логов.
- Провайдеры email: SMTP, Sendgrid, Mailgun, Postmark.
- Настройки доменов и DKIM/SPF.
- Группы подписок и предпочтения пользователей.
- Шаблоны писем с динамическими переменными.
- Статистика доставляемости и откликов.

**Основные сценарии**
- Настраивайте провайдера и тестируйте отправку через встроенную форму.
- Отправляйте транзакционные письма при событиях системы (регистрация, напоминания).
- Сегментируйте рассылки по группам подписок и языкам.
- Отслеживайте bounce и spam-репорты для чистоты базы.

**Продвинутые сценарии**
- Настраивайте ретрай политику и обработку временных ошибок.
- Используйте A/B тестирование темы и контента для маркетинговых писем.
- Интегрируйте пиксели отслеживания и вебхуки открытий.
- Планируйте рассылки по расписанию с учётом часовых поясов.

**Автоматизация и интеграции**
- Подключайте API провайдеров для управления списками и шаблонами.
- Используйте webhook `email.failed` для оперативного реагирования на сбои.
- Интегрируйте рассылки с CRM для персонализированных кампаний.
- Подключайте внешние CDP для расширенной аналитики по email.

**Тонкая настройка и отладка**
- Проверяйте аутентификацию домена (DKIM/SPF/DMARC) перед массовыми отправками.
- Тестируйте письма на разных клиентах и устройствах.
- Анализируйте задержки отправки, оптимизируя очередь.
- Документируйте регламенты по частоте рассылок и обработке отписок.


### Шаблоны писем и брендирование

Шаблонизатор писем использует Twig и поддерживает глобальные стили, вставки логотипов, динамические блоки и локализацию.

**Ключевые объекты и сущности**
- Базовый шаблон `email_template.twig` с секциями header/body/footer.
- Переменные бренда: цвета, логотипы, подписи.
- Фрагменты и partials для повторно используемых блоков.
- Локализация текстов и поддержка нескольких языков.
- Превью и тестовая отправка шаблонов.
- Версионность шаблонов и история изменений.

**Основные сценарии**
- Редактируйте шаблон письма через Twig, настраивая цвета и логотипы.
- Используйте переменные, чтобы подставлять имя получателя и данные проекта.
- Добавляйте динамические блоки (например, список активов или ссылку на проект).
- Проверяйте шаблон через тестовую отправку на командный email.

**Продвинутые сценарии**
- Создавайте многовариантные шаблоны для разных инстансов.
- Встраивайте условную логику и локализацию внутри шаблона.
- Используйте MJML или инлайн-стили для адаптивной верстки.
- Включайте AMP-секции для интерактивных элементов.

**Автоматизация и интеграции**
- Синхронизируйте шаблоны с Git для контроля версий.
- Интегрируйте с внешними редакторами email (например, Stripo) через экспорт HTML.
- Подключайте тему инстанса к публичным страницам и рассылкам.
- Используйте API для подстановки данных при генерации писем из внешних систем.

**Тонкая настройка и отладка**
- Проверяйте валидность HTML и совместимость с почтовыми клиентами.
- Тестируйте шаблон на доступность (alt-тексты, контрастность).
- Используйте инструменты предпросмотра для разных устройств.
- Документируйте структуру и переменные шаблона для разработчиков.


### Внутренние уведомления и алерты

Система уведомлений обеспечивает push-алерты в веб-интерфейсе, SMS, мессенджерах и внутренних журналах.

**Ключевые объекты и сущности**
- Типы уведомлений: задачи, сервисные заявки, конфликты ресурсов.
- Центр уведомлений в веб-клиенте с фильтрами.
- Настройки приоритетов и каналов доставки.
- Очередь уведомлений и статус доставки.
- Интеграция с SMS/мессенджер шлюзами.
- Журнал уведомлений для аудита.

**Основные сценарии**
- Получайте уведомления о назначенных задачах прямо в интерфейсе.
- Подписывайтесь на события проектов, чтобы не пропустить изменения.
- Настраивайте важность уведомлений и канал доставки для каждого пользователя.
- Просматривайте историю уведомлений и отметки о прочтении.

**Продвинутые сценарии**
- Создавайте кастомные правила, фильтруя уведомления по типу проекта или локации.
- Включайте SMS или звонки для критических событий (отказ оборудования).
- Настраивайте групповую маршрутизацию уведомлений для смен.
- Используйте отложенную доставку, чтобы не беспокоить ночью.

**Автоматизация и интеграции**
- Интегрируйте уведомления с Slack/Teams через вебхуки.
- Используйте REST API для создания уведомлений из внешних систем.
- Включайте сценарии инцидент-менеджмента через PagerDuty или Opsgenie.
- Настраивайте интеграцию с SMS-шлюзами и пуш-сервисами.

**Тонкая настройка и отладка**
- Мониторьте очередь уведомлений и отрабатывайте ошибки доставки.
- Тестируйте новые каналы на тестовых аккаунтах.
- Документируйте регламенты реакции на уведомления по приоритетам.
- Храните журналы доставки для расследования инцидентов.


### OpenAPI и клиентские SDK

OpenAPI-аннотации в коде позволяют генерировать документацию и SDK для интеграторов, упрощая разработку кастомных решений.

**Ключевые объекты и сущности**
- Аннотации swagger-php в файлах API.
- Файл `src/api/openApiYAMLHeaders.php` с глобальными метаданными.
- Сгенерированный swagger.json для публикации документации.
- CLI-команда для генерации SDK на разных языках.
- Примеры запросов и схемы ответов.
- Политики безопасности API (JWT, API-ключи, CORS).

**Основные сценарии**
- Просматривайте интерактивную документацию API через Swagger UI.
- Генерируйте клиентскую библиотеку на JS/PHP/TypeScript.
- Тестируйте запросы прямо из документации, подставляя токены.
- Обновляйте аннотации при изменении контрактов API.

**Продвинутые сценарии**
- Создавайте приватные эндпоинты с отдельными security схемами.
- Поддерживайте несколько версий API и документируйте их параллельно.
- Встраивайте документацию в портал разработчика.
- Используйте codegen для генерации серверных стабов при разработке микросервисов.

**Автоматизация и интеграции**
- Запускайте генерацию swagger.json в CI при каждом релизе.
- Публикуйте документацию в S3/CloudFront для доступа партнёров.
- Интегрируйте SDK в мобильные и настольные приложения.
- Используйте Postman Collections, экспортируемые из OpenAPI.

**Тонкая настройка и отладка**
- Проверяйте валидность OpenAPI схем линтерами (swagger-cli).
- Документируйте нестандартные типы данных и форматы.
- Поддерживайте примеры ошибок с кодами и описаниями.
- Обновляйте политики безопасности при изменении аутентификации.


### Вебхуки и внешние автоматизации

Событийная модель вебхуков уведомляет внешние системы о ключевых изменениях: создания проектов, перемещениях активов, оплата.

**Ключевые объекты и сущности**
- Настройки вебхуков с URL, секретом и фильтрами событий.
- Очередь отправки и механизмы повторных попыток.
- Подписки на конкретные типы событий (asset.updated, project.created).
- Логи ответов сторонних систем.
- Инструменты тестовой доставки и подписания payload.
- Защита подписью HMAC и whitelisting IP.

**Основные сценарии**
- Создавайте вебхуки для интеграции с CRM и таск-трекерами.
- Получайте уведомления о смене статуса проекта в внешние системы.
- Обновляйте складские остатки в сторонних приложениях при движении активов.
- Фиксируйте поступление платежей и обновляйте финансы проекта.

**Продвинутые сценарии**
- Используйте подписки по фильтрам инстанса или типу проекта.
- Реализуйте пользовательские события через кастомные скрипты.
- Отправляйте вебхуки в очереди RabbitMQ/Kafka для дальнейшей обработки.
- Включайте подпись тела запроса и проверку на стороне получателя.

**Автоматизация и интеграции**
- Интегрируйте с iPaaS (Make, Zapier) для оркестрации процессов.
- Подключайте ERP и складские системы для синхронизации данных.
- Автоматически создавайте тикеты в ServiceNow или Jira.
- Используйте вебхуки для запуска CI/CD или оповещения DevOps.

**Тонкая настройка и отладка**
- Отслеживайте статус доставки и ретраев в журнале вебхуков.
- Тестируйте обработку подписей на стенде до запуска в прод.
- Документируйте схемы payload для партнёров.
- Настраивайте rate limit и защиту от повтора.


### Дашборды, виджеты и визуализация

Дашборды объединяют ключевые метрики: состояние активов, загрузку проектов, финансы. Виджеты можно конфигурировать под роль пользователя.

**Ключевые объекты и сущности**
- Главный дашборд с виджетами по активам, проектам и задачам.
- Конфигуратор виджетов и порядок их отображения.
- Виджеты статистики, списков и диаграмм.
- Права на просмотр конкретных блоков.
- Режим настенных экранов для офиса или склада.
- API `statsWidgets.php` для расширений.

**Основные сценарии**
- Настраивайте виджеты под свои роли (логистика, финансы, менеджмент).
- Фильтруйте данные дашборда по инстансу и времени.
- Используйте диаграммы для контроля KPI по проектам.
- Включайте полноэкранный режим для мониторинга склада.

**Продвинутые сценарии**
- Создавайте кастомные виджеты через Twig и PHP расширения.
- Подключайте внешние источники данных (BI, Google Sheets).
- Настраивайте условия отображения виджетов по ролям.
- Экспортируйте данные виджетов в CSV для дальнейшего анализа.

**Автоматизация и интеграции**
- Интегрируйте дашборды в корпоративные порталы через iframe и SSO.
- Используйте webhook-обновления, чтобы виджеты реагировали на события в реальном времени.
- Подключайте API для передачи данных в внешние визуализации.
- Встраивайте метрики в мобильные приложения и Progressive Web Apps.

**Тонкая настройка и отладка**
- Проверяйте производительность при большом количестве виджетов.
- Следите за корректной кэшированием данных, чтобы избегать устаревания.
- Тестируйте отображение на разных разрешениях и устройствах.
- Документируйте конфигурации дашбордов для разных ролей.


### Поиск, фильтры и сохранённые представления

Поисковый движок позволяет мгновенно находить активы, проекты и клиентов, используя полнотекст и структурные фильтры.

**Ключевые объекты и сущности**
- Глобальный поиск по ключевым сущностям.
- Расширенные фильтры с поддержкой логических операторов.
- Сохранённые представления и избранные фильтры.
- API поиска для интеграций.
- Индексация данных и обновление кэшей.
- Права на доступ к отдельным наборам данных.

**Основные сценарии**
- Используйте глобальный поиск для быстрого перехода к нужной карточке.
- Сочетайте фильтры по статусу, типу и локации, чтобы сузить выдачу.
- Сохраняйте фильтры как представления и делитесь ими с командой.
- Экспортируйте результаты поиска в CSV для офлайн-анализа.

**Продвинутые сценарии**
- Создавайте фильтры с пользовательскими полями и диапазонами.
- Используйте регулярные выражения в поиске по серийным номерам.
- Настраивайте ранжирование и подсветку результатов.
- Интегрируйте поиск с внешними BI для построения отчётов.

**Автоматизация и интеграции**
- Вызывайте API поиска для построения кастомных панелей.
- Используйте webhooks, чтобы актуализировать сохранённые представления при изменении данных.
- Интегрируйте поиск в мобильные приложения через REST.
- Подключайте Elasticsearch или аналогичные движки при больших объёмах.

**Тонкая настройка и отладка**
- Перестраивайте индексы после массовых изменений структуры.
- Анализируйте логи поиска, чтобы улучшать подсказки.
- Оптимизируйте фильтры для быстрого отклика в больших инстансах.
- Документируйте сложные запросы и делитесь паттернами с командой.


### Аналитика, отчёты и BI

Модуль аналитики предоставляет готовые отчёты и возможность интеграции с BI-системами для углублённого анализа.

**Ключевые объекты и сущности**
- Стандартные отчёты по активам, проектам, финансам.
- Конструктор отчётов с выбором полей и агрегатов.
- Экспорт в Excel, CSV, PDF.
- API для передачи данных в BI (Power BI, Tableau, Looker).
- Планировщик регулярных отчётов.
- Метрики производительности и SLA.

**Основные сценарии**
- Запускайте стандартные отчёты для оценки остатка и оборота активов.
- Стройте кастомные отчёты, выбирая поля и фильтры.
- Настраивайте автоматическую отправку отчётов по email.
- Используйте графики и сводки на дашбордах руководства.

**Продвинутые сценарии**
- Объединяйте данные из нескольких инстансов для холдинговых отчётов.
- Создавайте показатели эффективности (KPI) и следите за ними во времени.
- Используйте cohort-анализ для клиентов и проектов.
- Стройте прогнозы спроса на оборудование на основе исторических данных.

**Автоматизация и интеграции**
- Выгружайте данные через API или прямые SQL-подключения к реплике.
- Интегрируйте с BI-платформами, используя коннекторы и ETL.
- Публикуйте отчёты в корпоративных порталах и Slack.
- Используйте webhook-и для обновления дашбордов при изменении данных.

**Тонкая настройка и отладка**
- Проверяйте корректность агрегатов и формул перед релизом отчёта.
- Следите за производительностью запросов и оптимизируйте индексы.
- Документируйте источники данных и методологии расчётов.
- Настраивайте уровни доступа к отчётам согласно политике безопасности.


### Телеметрия и мониторинг производительности

Телеметрия фиксирует технические метрики: время ответа, ошибки, использование API. Она интегрируется с Sentry и внешними APM.

**Ключевые объекты и сущности**
- Настройки Telemetry уровней (Disabled, Limited, Standard).
- Инструменты логирования и трассировки запросов.
- Интеграция с Sentry для ошибок и performance traces.
- Метрики базы данных и кэширования.
- Журнал фоновых задач и очередей.
- Экспорт метрик в Prometheus/Grafana.

**Основные сценарии**
- Включайте телеметрию для мониторинга критичных инстансов.
- Анализируйте время отклика API и страницы через отчёты.
- Отслеживайте ошибки PHP и исключения в Sentry.
- Мониторьте использование ресурсов сервера и БД.

**Продвинутые сценарии**
- Настраивайте trace для долгих запросов и оптимизируйте SQL.
- Интегрируйте с APM (New Relic, Datadog) через агенты.
- Используйте метрики очередей для балансировки фоновых задач.
- Создавайте алерты по SLA для команд поддержки.

**Автоматизация и интеграции**
- Отправляйте метрики в Prometheus и строьте графики в Grafana.
- Интегрируйте с Opsgenie/PagerDuty для инцидент-менеджмента.
- Используйте вебхуки Sentry для автоматического создания тикетов.
- Экспортируйте логи в SIEM для безопасности.

**Тонкая настройка и отладка**
- Проверяйте влияние телеметрии на производительность.
- Фильтруйте чувствительные данные из логов.
- Документируйте SLA и пороговые значения метрик.
- Регулярно пересматривайте настройки sampling и retention.


### Конфигурация и управляемые параметры

Конфигурационный модуль объединяет параметры из базы данных, `.env` и значений по умолчанию, обеспечивая централизованное управление.

**Ключевые объекты и сущности**
- Форма Config с группами настроек.
- Файл `configStructureArray.php` с описанием параметров.
- Поддержка env-переменных и значений по умолчанию.
- Кэширование конфигурации в `$CONFIG` и доступ через `$CONFIGCLASS`.
- История изменений конфигурации.
- Права на изменение чувствительных настроек.

**Основные сценарии**
- Настраивайте ключевые параметры (ROOTURL, EMAILS_ENABLED, AWS_S3).
- Используйте форму Config для обновления значений без редактирования файлов.
- Применяйте различные профили конфигурации на staging и production.
- Проверяйте валидность введённых значений через встроенную валидацию.

**Продвинутые сценарии**
- Расширяйте схему конфигурации новыми параметрами через код.
- Используйте секреты в `.env` и скрытые поля в UI.
- Включайте feature-флаги для постепенного развёртывания функций.
- Связывайте конфигурацию с Ansible/Terraform через API.

**Автоматизация и интеграции**
- Экспортируйте конфигурацию в JSON для хранения в GitOps.
- Интегрируйте изменение параметров с CI/CD конвейером.
- Используйте REST API для чтения конфигурации внешними сервисами.
- Настройте уведомления о критических изменениях конфигурации.

**Тонкая настройка и отладка**
- Проверяйте совместимость параметров перед деплоем.
- Документируйте влияние каждого параметра на систему.
- Используйте флаги режима обслуживания для безопасных обновлений.
- Отслеживайте изменения в журнале Config Audit.


### Миграции базы данных и сиды

Phinx-миграции управляют схемой базы данных, а сиды наполняют справочники и тестовые данные.

**Ключевые объекты и сущности**
- Папка `db/migrations` с версионированными миграциями.
- Папка `db/seeds` для исходных данных.
- Команда `phinx migrate` и `phinx seed:run`.
- Конфигурация `phinx.php` с окружениями.
- Журнал выполненных миграций в таблице `phinxlog`.
- Скрипт `migrate.sh` для автоматического применения.

**Основные сценарии**
- Создавайте миграции для изменения структуры таблиц.
- Пишите сиды для справочников и тестовых данных.
- Запускайте миграции при деплое или запуске контейнеров.
- Откатывайте миграции при необходимости через `phinx rollback`.

**Продвинутые сценарии**
- Разделяйте миграции по доменам и используйте именование для порядкового применения.
- Проверяйте миграции на staging перед production.
- Используйте миграции для обновления данных (data-migrations) с логированием.
- Документируйте зависимости между миграциями и версиями приложения.

**Автоматизация и интеграции**
- Интегрируйте запуск миграций в CI/CD pipeline.
- Используйте контейнеры для прогонов миграций в изолированной среде.
- Создавайте уведомления в Slack о результатах миграций.
- Подключайте мониторинг длительности миграций для оптимизации.

**Тонкая настройка и отладка**
- Проверяйте транзакционность операций и возможность отката.
- Используйте dry-run режим перед боевым запуском.
- Документируйте схемы таблиц после крупных изменений.
- Храните SQL-дампы для быстрого восстановления при ошибках.


### DevOps, контейнеризация и развёртывание

Инфраструктурный стек включает Docker-образ, docker-compose, Dev Container, что упрощает запуск и CI/CD.

**Ключевые объекты и сущности**
- Dockerfile с набором PHP-расширений и конфигурацией Apache.
- docker-compose.yml с сервисами приложения и MySQL.
- Devcontainer конфигурация для VS Code.
- CI/CD сценарии для сборки и деплоя.
- Настройки environment variables через `.env`.
- Скрипты healthcheck и миграции.

**Основные сценарии**
- Запускайте окружение через `docker compose up`.
- Используйте Dev Container для разработки с готовыми сервисами.
- Развёртывайте приложение на staging/production через контейнерные образы.
- Настраивайте переменные окружения в `.env` и CI секретах.

**Продвинутые сценарии**
- Создавайте многоузловые окружения с отдельными сервисами (S3, Redis).
- Используйте GitOps подход с автоматическим деплоем по тегам.
- Оптимизируйте Dockerfile для быстрого билда и кеширования.
- Интегрируйте rolling-update стратегии в Kubernetes.

**Автоматизация и интеграции**
- Настраивайте CI pipelines (GitHub Actions, GitLab CI) для тестов и деплоя.
- Интегрируйте Infrastructure as Code (Terraform, Ansible).
- Используйте образы как артефакты и версионируйте их.
- Подключайте мониторинг контейнеров через Prometheus и Grafana.

**Тонкая настройка и отладка**
- Тестируйте обновления PHP и зависимостей на staging.
- Следите за размером образов и временем запуска.
- Документируйте процесс выпуска и отката релизов.
- Используйте healthchecks для автоматического восстановления сервисов.


### Безопасность, аудит и комплаенс

Безопасность включает контроль доступа, аудит, шифрование и соответствие стандартам (GDPR, ISO).

**Ключевые объекты и сущности**
- Аудит-лог действий пользователей и администраторов.
- Настройки паролей, MFA и политик входа.
- Шифрование данных в покое и при передаче.
- Политики доступа к файлам и конфиденциальным данным.
- Мониторинг подозрительной активности.
- Процедуры реагирования на инциденты.

**Основные сценарии**
- Включайте MFA для администраторов и критических ролей.
- Отслеживайте входы и неудачные попытки в аудит-логе.
- Настраивайте права доступа на чувствительные разделы.
- Используйте HTTPS и актуальные сертификаты.

**Продвинутые сценарии**
- Проводите регулярные аудиты прав доступа и удаляйте лишние роли.
- Включайте SSO и SCIM для централизованной безопасности.
- Применяйте шифрование базы данных и секретов.
- Проводите penetration testing и анализ уязвимостей.

**Автоматизация и интеграции**
- Интегрируйте логи в SIEM для корреляции событий.
- Используйте автоматические алерты при подозрительных действиях.
- Связывайте систему с DLP и CASB решениями.
- Документируйте политику доступа и распределяйте через порталы.

**Тонкая настройка и отладка**
- Проверяйте конфигурацию TLS и обновляйте сертификаты заранее.
- Тестируйте сценарии восстановления после компрометации.
- Храните инструкции по реагированию на инциденты.
- Регулярно обучайте персонал по вопросам безопасности.


### Интернационализация и локализация

Система поддерживает многоязычные интерфейсы, локализацию контента и форматов дат/валют.

**Ключевые объекты и сущности**
- Файлы перевода интерфейса и шаблонов.
- Настройки языка пользователя и инстанса.
- Форматы дат, времени и валют.
- Локализация email и уведомлений.
- Справочники переводов пользовательских полей.
- Инструменты проверки полноты локализации.

**Основные сценарии**
- Выбирайте язык интерфейса для пользователя или инстанса.
- Переводите страницы CMS и email-шаблоны.
- Используйте правильные форматы дат и чисел по региону.
- Синхронизируйте переводы при добавлении новых функций.

**Продвинутые сценарии**
- Добавляйте новые языки, создавая файлы перевода.
- Настраивайте множественные валюты и курсы.
- Используйте fallback-языки для незавершённой локализации.
- Проводите лингвистическое тестирование на staging.

**Автоматизация и интеграции**
- Интегрируйте локализацию с Crowdin/Lokalise через API.
- Экспортируйте файлы переводов в Git для ревью.
- Используйте webhooks для оповещения переводчиков о новых строках.
- Автоматически проверяйте форматные плейсхолдеры при сборке.

**Тонкая настройка и отладка**
- Проверяйте длину строк в интерфейсе, чтобы избежать обрезания.
- Следите за актуальностью переводов после релизов.
- Документируйте глоссарий терминов для переводчиков.
- Используйте автоматические тесты для контроля локализации.


### CMS, страницы портала и контент

Встроенная CMS управляет страницами портала, новостями, инструкциями и виджетами для пользователей.

**Ключевые объекты и сущности**
- Страницы CMS с Twig-шаблонами и Markdown контентом.
- Права на редактирование контента.
- Модуль новостей и объявлений.
- Динамические блоки на дашбордах.
- История изменений страниц.
- Публикация и расписание обновлений.

**Основные сценарии**
- Создавайте информационные страницы для команды и клиентов.
- Публикуйте новости об обновлениях и плановых работах.
- Используйте динамические блоки на главной для важных уведомлений.
- Контролируйте доступ к редактированию через роли.

**Продвинутые сценарии**
- Включайте многоверсионность и предварительный просмотр.
- Используйте Twig для вставки динамических данных (например, статистики).
- Настраивайте расписание публикаций и автодепубликацию.
- Интегрируйте контент с внешними CMS через API.

**Автоматизация и интеграции**
- Публикуйте новости в Slack/Email автоматически.
- Используйте webhooks для синхронизации с корпоративными порталами.
- Экспортируйте контент в статические сайты.
- Связывайте CMS страницы с QR-кодами на оборудовании.

**Тонкая настройка и отладка**
- Тестируйте отображение контента на мобильных устройствах.
- Проверяйте ссылки и медиа на актуальность.
- Документируйте структуру контента и владельцев.
- Используйте ревью-процесс перед публикацией критичных инструкций.


### Публичные каталоги и гостевой доступ

Публичный режим позволяет публиковать часть каталога активов или расписание проектов для клиентов и партнёров.

**Ключевые объекты и сущности**
- Настройки гостевого доступа и уровни видимости.
- Публичные страницы каталога и проектов.
- Фильтры и поиск в публичном интерфейсе.
- Права на загрузку файлов и просмотр медиа.
- Аудит запросов и ограничение по IP.
- Интеграция с формами обратной связи.

**Основные сценарии**
- Публикуйте витрину аренды оборудования для клиентов.
- Делитесь расписанием мероприятий с партнёрами.
- Используйте пароль или токен для ограниченного гостевого доступа.
- Собирайте заявки прямо с публичной страницы.

**Продвинутые сценарии**
- Настраивайте white-label оформление под клиента.
- Включайте динамическое ценообразование в публичных каталогах.
- Ограничивайте географию доступа по IP.
- Интегрируйте чат-ботов и онлайн-консультантов.

**Автоматизация и интеграции**
- Передавайте публичные данные в внешние витрины через API.
- Связывайте каталог с e-commerce платформами.
- Используйте webhooks для уведомления о новых заявках.
- Встраивайте публичные страницы в сайты клиента через iframe.

**Тонкая настройка и отладка**
- Тестируйте доступ под гостевыми учётками и без авторизации.
- Следите за безопасностью данных, исключая конфиденциальные поля.
- Документируйте процедуры обновления каталога.
- Используйте аналитические инструменты для отслеживания трафика.


### Интеграции с календарями и iCal

Интеграции с календарями обеспечивают подписку на расписания проектов, доступность ресурсов и напоминания.

**Ключевые объекты и сущности**
- Генерация iCal ссылок для проектов и ресурсов.
- Синхронизация с Google Calendar, Outlook, Exchange.
- Настройки приватности и токены доступа.
- Календарные уведомления и напоминания.
- Экспорт расписания в формате ICS.
- Логи обновлений календаря.

**Основные сценарии**
- Подписывайтесь на календарь проекта в Google Calendar.
- Экспортируйте расписание ресурсов для внешних команд.
- Настраивайте напоминания о монтаже/демонтаже.
- Обновляйте календарь автоматически при изменениях проекта.

**Продвинутые сценарии**
- Используйте приватные токены для закрытых проектов.
- Интегрируйте с корпоративными календарями через Exchange Web Services.
- Создавайте отдельные каналы для клиентов и подрядчиков.
- Синхронизируйте изменения в обе стороны через API.

**Автоматизация и интеграции**
- Настраивайте автоматическую отправку ICS-файлов при подтверждении бронирования.
- Используйте вебхуки календарных сервисов для обновления статусов.
- Интегрируйте расписание с системами контроля доступа.
- Публикуйте календарь на корпоративных панелях через CalDAV.

**Тонкая настройка и отладка**
- Проверяйте корректность временных зон и переходов на летнее время.
- Тестируйте интеграции на тестовых почтовых ящиках.
- Документируйте регламенты обновления календарей.
- Следите за лимитами API календарных сервисов.


## Приложение A. Детализированные каталоги функций и регламентов

### A.1 Управление инстансами и организациями: разбор сущностей, атрибутов и связей

**Сущности первого уровня**
- `instances` — базовая таблица организации. Ключевые поля: `id`, `name`, `subdomain`, `timezone`, `status`, `plan`, `billingCustomerId`, `createdAt`, `updatedAt`, `suspendedReason`. Каждое поле сопровождается триггером обновления аналитики.
- `instanceMembers` — членство пользователей. Основные поля: `userId`, `instanceId`, `role`, `permissionsMatrix`, `invitedBy`, `joinedAt`, `lastActiveAt`, `suspensionState`.
- `instanceSettings` — расширенные настройки. Поля: `key`, `value`, `type`, `scope`, `overriddenBy`, `locked`, `validatedAt`.
- `instanceDomains` — привязанные домены. Поля: `domain`, `verificationToken`, `verifiedAt`, `sslMode`, `lastSync`.
- `instanceBilling` — платёжные параметры. Поля: `planId`, `nextInvoiceAt`, `stripeSubscriptionId`, `trialEndsAt`, `overageCredits`.

**Сущности второго уровня**
- `instanceRoles` с настройкой матрицы прав; включает `roleId`, `roleName`, `inheritsFrom`, `permissionsJson`, `systemRole` (флаг встроенной роли).
- `instanceInvites` — приглашения пользователей: `token`, `expiresAt`, `email`, `inviteeName`, `inviterId`, `acceptedAt`, `revokedAt`.
- `instanceAuditLog` — журнал действий: `eventId`, `actorId`, `targetType`, `targetId`, `action`, `payload`, `ipAddress`, `userAgent`, `createdAt`.
- `instanceIntegrations` — подключенные сервисы (Slack, Teams): `integrationType`, `status`, `configurationJson`, `lastHealthcheck`, `errorCode`, `errorMessage`.
- `instanceAnnouncements` — глобальные сообщения: `title`, `body`, `visibility`, `startAt`, `endAt`, `dismissible`, `dismissedBy`.

**Типы статусов инстанса**
- `active` — доступен полный функционал; включены уведомления, отчёты, API.
- `trialing` — действует пробный период; ограничения по количеству проектов и пользователей.
- `suspended` — блокируется доступ, инициируется рассылка уведомлений владельцам и сохранение резервных копий.
- `archived` — только чтение, скрыт из выборки, но сохраняется история.
- `pendingVerification` — требуется подтверждение домена и контактных данных.

**Регламент жизненного цикла**
1. Создание: форма регистрации ➜ генерация `instance` + запись `instanceMembers` для администратора.
2. Первичная настройка: заполнение конфигурации (SMTP, S3, бренд) ➜ создание записей `instanceSettings` ➜ проверка домена.
3. Эксплуатация: регулярные операции, мониторинг здоровья интеграций, аудит действий.
4. Расширение: подключение дополнительных доменов, добавление отделов, настройка кастомных ролей.
5. Завершение: архивирование или экспорт данных, отключение интеграций, формирование отчётов для compliance.

**UI-компоненты**
- Панель «Общие сведения» с карточками: статус, тариф, ключевые метрики.
- Мастер настройки: пошаговые вкладки (Базовые данные → Логотип → Домены → Интеграции → Платежи).
- Управление пользователями: таблица с фильтрами по ролям, датам активности, статусу приглашения.
- Журнал безопасности: временная шкала событий с фильтрами по типу (авторизация, изменение прав, экспорт).
- Виджет здоровья интеграций: индикаторы статуса, кнопки повторной авторизации, ссылки на лог.

**API-эндпоинты и вебхуки**
- `POST /api/instances/create` — создание инстанса (используется облачной панелью).
- `GET /api/instances/{id}` — информация с расширенной матрицей прав.
- `POST /api/instances/{id}/suspend` — ручная заморозка (требует `SERVER:MANAGE_INSTANCES`).
- `POST /api/instances/{id}/invite` — приглашение пользователя, поддерживает массовую отправку.
- `DELETE /api/instances/{id}/domain/{domain}` — отвязка домена с каскадным отзывом сертификата.
- `POST /api/instances/{id}/webhooks/test` — отправка тестового webhook, проверка сигнатуры HMAC.

**Автоматизации**
- Планировщик (cron) проверяет `nextInvoiceAt`, создаёт инвойс в Stripe, обновляет `instanceBilling`.
- Монитор доменов валидирует SSL каждые 6 часов, регистрирует предупреждения в `instanceAuditLog`.
- Автоприглашение сотрудников по списку доменных email — через обработчик очереди, который сверяет MX-записи.
- Скрипт мониторинга активности переводит инстанс в `suspended` при неудачных платежах и отправляет уведомления.

**Соображения безопасности**
- Все административные действия пишутся в `instanceAuditLog` с контекстом IP/UA.
- Доменная проверка выполняется через TXT-запись или HTTP-файл; повторные попытки ограничены rate-limit.
- Парольные политики инстанса задаются в `instanceSettings` и прокидываются в UI форм регистрации и API.
- Уровни доступа: серверный супер-админ (SaaS), владельцы инстанса, менеджеры, наблюдатели.

**Диагностика и отладка**
- Проверяйте график `instanceHealth` в аналитике для выявления просадок производительности.
- Используйте `?debugInstance=ID` для просмотра расширенных данных в dev-окружении.
- Логи Stripe/платежей синхронизируются в `instanceBillingEvents` (при failover можно повторно проиграть события).
- При импорте данных (CSV) логируются предупреждения о несоответствии схемы.

---

### A.2 Управление пользователями, доступами и политиками

**Категории пользователей**
- Внешний пользователь (клиент) — ограниченный доступ к порталу, может подтверждать сметы и отслеживать статусы.
- Внутренний сотрудник — участник команды проекта, доступ к ресурсам в рамках инстанса.
- Менеджер проектов — расширенные права на утверждение бюджетов, управление задачами.
- Супервайзер/администратор — полный доступ к настройкам, аудиту, конфигурации.
- Системный пользователь (бот/интеграция) — выдаётся сервисным токенам, для автоматизации.

**Матрица прав**
- `ACCOUNT:INVITE_USERS`, `ACCOUNT:MANAGE_ROLES`, `ACCOUNT:VIEW_AUDIT` — базовые серверные разрешения.
- `INSTANCE:MANAGE_ASSETS`, `INSTANCE:MANAGE_FINANCE`, `INSTANCE:APPROVE_PROJECTS`, `INSTANCE:EXPORT_DATA`.
- `PROJECT:CREATE`, `PROJECT:UPDATE`, `PROJECT:CLOSE`, `PROJECT:MANAGE_STAFF`.
- `FINANCE:VIEW_COSTS`, `FINANCE:EDIT_RATES`, `FINANCE:LOCK_BUDGET`, `FINANCE:ISSUE_INVOICE`.
- `INTEGRATION:CONNECT`, `INTEGRATION:DISCONNECT`, `INTEGRATION:READ_LOGS`.

**Комбинации ролей**
- Стандартные: Администратор, Менеджер, Координатор, Техник, Просмотр.
- Кастомные: создаются через UI, наследуют наборы из стандартных, могут переопределять отдельные полномочия.
- Роли для интеграций: ограниченный доступ к API, выдаётся токенам без пароля.
- Временные роли: активируются в диапазоне дат (например, для сезонных проектов).

**Двухфакторная аутентификация (2FA)**
- Поддерживаемые методы: TOTP (Google Authenticator), WebAuthn (ключи безопасности), Email OTP (резерв).
- Настройки: принудительное включение для ролей, политика восстановления, резервные коды.
- Процедура onboarding: показывается wizard при первом входе.
- Логи: успешные/неуспешные проверки сохраняются в `authEvents` с метаданными устройства.

**Процесс входа и восстановления**
1. Ввод email/пароля ➜ проверка rate-limit и блокировок.
2. Проверка 2FA (если включено).
3. Обновление `lastActiveAt`, запись `LOGIN_SUCCESS` в аудит.
4. При забытом пароле: запрос magic link, генерация токена с TTL, отправка через выбранного email-провайдера.
5. Если пользователь заблокирован, инициируется workflow `ACCOUNT:SUSPEND_USER` с причинами и сроками.

**API и токены**
- `POST /api/auth/login`, `POST /api/auth/logout`, `POST /api/auth/token/refresh`.
- `POST /api/auth/magic` — отправка magic link; поддерживает конфигурацию шаблонов.
- `GET /api/auth/tokens` — просмотр активных токенов, отзыв.
- `POST /api/auth/service-tokens` — выдача токенов для интеграций с ограничениями по IP.
- Ограничения: максимальное количество активных токенов на пользователя, уведомления при превышении.

**Управление безопасностью**
- Политика паролей: минимальная длина, класс символов, срок действия, запрет на reuse.
- Политика сессий: автоматический выход при неактивности, список активных сессий.
- Настройки уведомлений: отправка писем при входе с нового устройства, изменении пароля.
- Сегрегация обязанностей: блокировка комбинации прав (например, нельзя одновременно редактировать и утверждать счета).

**Отчётность и аудит**
- Dashboards по активности пользователей, heatmap логинов, отчёты по нарушителям.
- Экспорт журналов в CSV, JSON, SIEM-коннекторы (Splunk, ELK).
- Реакция на инциденты: сценарии эскалации, playbooks, интеграция с PagerDuty.

---

### A.3 Управление инвентарём и логистикой: глубокий разбор

**Структура каталога**
- `assetCategories` → `assetSubcategories` → `assetItems` → `assetUnits` (конкретные серийные экземпляры).
- Доп. таблицы: `assetSuppliers`, `assetLocations`, `assetMaintenance`, `assetDocuments`, `assetCustomFields`.
- Расширение: `assetBundles` и `assetBundleItems` для комплектов.

**Ключевые атрибуты единицы**
- Идентификатор, инвентарный номер, серийный номер, штрихкод.
- Локация (основной склад, удалённая площадка, в пути).
- Статус (`available`, `reserved`, `checked_out`, `maintenance`, `lost`).
- Стоимость приобретения, амортизация, остаточная стоимость.
- Гарантийный срок, сервисный контракт, контакт поставщика.
- Связанное оборудование (кабели, кейсы), хрупкость, условия хранения.

**Операции над инвентарём**
- Создание/импорт: CSV-шаблон с картой полей; поддержка перевода валют при импорте цен.
- Редактирование: массовое изменение атрибутов, история правок.
- Перемещение: внутренняя заявка на перемещение между складами, QR-сканирование.
- Комплектация: сборка комплектов, проверка на конфликт резервирования.
- Списание/утилизация: создание акта, привязка фотографий, экспорт в финучёт.

**Логистические процессы**
- Пик-листы по проектам: генерация по расписанию, печать QR-ярлыков.
- Отправка и возврат: чеклисты, подпись получателя, фотофиксация.
- Учет повреждений: оформление инцидента, оценка стоимости ремонта, списание на клиента или страховку.
- Логистика между филиалами: планирование транспорта, подтверждение водителем через мобильный интерфейс.

**Интеграции и автоматизация**
- Подключение к системам сканеров (Bluetooth, мобильные приложения).
- Синхронизация с ERP/Accounting (например, 1C, NetSuite) по API.
- Настройка пороговых уведомлений: низкий остаток, просроченная калибровка.
- Вебхуки для обновления статусов в сторонних системах.

**Глубокая аналитика**
- Отчёты по загрузке ресурсов (utilization rate) с разбивкой по категориям.
- ROI-анализ по каждому активу: доходы от аренды, стоимость обслуживания.
- Тепловые карты повреждений, графики сезонности.
- KPI по логистике: время сборки, процент своевременных возвратов.

**Контроль качества**
- Процедуры приёмки, чек-листы, фотоверификация.
- Тестовые протоколы, календарь калибровок.
- Инструкции по чистке, хранению, профилактике.
- Отметки о проведённых ремонтах, ответственные лица.

---

### A.4 Проектный модуль и операции на площадке

**Жизненный цикл проекта**
1. Лид/заявка ➜ квалификация ➜ предварительная смета.
2. Планирование ресурсов: бронирование инвентаря, подбор персонала, бронирование площадок.
3. Подтверждение клиентом ➜ генерация договора и графика платежей.
4. Предпроизводственный этап: чек-листы, технические задания, расписание.
5. Производственный этап: контроль задач, логистика, фиксирование изменений.
6. Постпроизводство: возврат оборудования, финальный отчёт, закрытие проекта.

**Сущности проекта**
- `projects` с атрибутами: `code`, `title`, `clientId`, `status`, `startDate`, `endDate`, `location`, `budget`, `marginTarget`.
- `projectPhases` — этапы, порядок, статусы.
- `projectTasks` — задачи, исполнители, дедлайны, чеклисты, вложения.
- `projectAssignments` — назначения сотрудников, ставки, расписание смен.
- `projectEquipment` — связка с инвентарём, статусы резервирования.
- `projectDocuments` — договоры, брифы, акт выполненных работ.
- `projectFinances` — счета, платежи, план-факт.

**Настройка статусов**
- Предварительные: `lead`, `proposal`, `negotiation`.
- Рабочие: `confirmed`, `in_progress`, `on_hold`, `awaiting_feedback`.
- Завершение: `completed`, `closed`, `cancelled`, `archived`.
- Кастомные: возможно добавление дополнительных статусов с правилами переходов.

**Визуальные представления**
- Доска Kanban по статусам.
- Гант-диаграмма и расписание смен.
- Таймлайн логистики (погрузка, монтаж, репетиции, демонтаж).
- Финансовый дашборд: прогноз доходов, cashflow, план-факт по затратам.
- Карта мест проведения с геолокацией и маршрутами.

**Коллаборация**
- Комментарии, упоминания, вложения.
- Протокол согласований, голосование за решения.
- Протоколы совещаний (minutes), контроль решений.
- Интеграция с чатами (Slack/Teams), автоматическое создание каналов.

**Управление рисками**
- Реестр рисков: идентификаторы, вероятность, влияние, ответственные.
- План действий: триггеры, mitigation, contingency.
- Мониторинг: автоматическое обновление статусов при наступлении события.
- Постмортем: шаблон отчёта, lessons learned, действия по улучшению.

**Выездные операции**
- Мобильный чек-лист задач и инвентаря.
- Подпись на месте (электронная подпись клиента).
- Логирование времени прибытия/убытия.
- Фотодокументация, синхронизация оффлайн после восстановления сети.

**Инциденты и изменения**
- Change Requests: фиксирование, оценка влияния, согласование.
- Инциденты: классификация (оборудование, персонал, погода), уведомления.
- Эскалация: цепочка ответственных, интеграция с PagerDuty.
- Постобработка: анализ причин, обновление базы знаний.

---

### A.5 Финансовый модуль и расчёты

**Структура**
- `financeBudgets`, `financeBudgetLines`, `financeCostCenters`.
- `financeInvoices`, `financeInvoiceLines`, `financePayments`, `financePaymentAllocations`.
- `financeExpenses`, `financeExpenseReceipts`, `financeExpenseApprovals`.
- `financeRates` — ставки, валюты, типы (суточная, почасовая).
- `financeTaxes` — ставки налогов по регионам и категориям.

**Процессы**
- Планирование бюджета: шаблоны, допущения, версии.
- Утверждение смет: workflow с участием клиента и внутренних служб.
- Учёт затрат: загрузка чеков через мобильное приложение, OCR распознавание, маршрутизация на утверждение.
- Выставление счетов: генерация PDF, отправка клиенту, отслеживание платежей.
- Финальный расчёт: распределение фактических расходов, маржинальность, акты.

**Автоматизация**
- Обновление валютных курсов (ECB, ЦБ РФ, локальные источники).
- Автоперенос затрат из логистики и проектов.
- Триггеры уведомлений при превышении бюджета.
- Экспорт в бухгалтерию (1C, QuickBooks, Xero, NetSuite).

**Контроль и отчёты**
- Финансовый календарь платежей.
- Cashflow-прогноз и фактические поступления.
- Анализ profitability по клиентам, регионам, категориям услуг.
- Аудит соответствия политике (approval matrix, лимиты).

**Настройки налогов и юридических документов**
- Поддержка разных налоговых режимов (НДС, GST, VAT).
- Настраиваемые шаблоны договоров, актов, накладных.
- Электронная подпись и интеграция с операторами ЭДО.
- Хранение печатей, реквизитов, банковских счетов.

---

### A.6 Коммуникации, уведомления и клиентский портал

**Каналы**
- Email, SMS, push, мессенджеры (Slack, Teams), веб-портал, iCal.
- Голосовые звонки через интеграцию с VoIP (опционально).

**Шаблоны**
- Системные: подтверждение регистрации, сброс пароля, 2FA.
- Проектные: приглашения на площадку, изменение расписания, отчёты.
- Финансовые: счета, напоминания о платежах, подтверждение оплаты.
- Кастомные: брендированные шаблоны на Twig с поддержкой условий и списков.

**Маршрутизация**
- Условные правила: сегментация по роли, статусу проекта, языку.
- Расписания отправки, таймзоны, ограничения по ночным часам.
- Вебхуки для фиксации доставляемости, обработка bounce, unsubscribe.

**Клиентский портал**
- Доступ к проектам, документам, статусам.
- Возможность подтверждения смет, загрузки файлов, комментирования.
- История коммуникаций, уведомления в реальном времени.
- Прозрачность логистики: отслеживание статуса оборудования.

**Контроль качества коммуникаций**
- SLA по времени ответа, отчёты по коммуникациям.
- A/B тесты шаблонов, анализ открываемости писем.
- Интеграция с CRM для единого профиля клиента.

---

### A.7 Интеграции, API, вебхуки и ETL

**Категории интеграций**
- SaaS-коммуникации (Slack, Teams, Zoom).
- Финансы (Stripe, PayPal, 1C, QuickBooks, Xero, NetSuite).
- Календарь и планирование (Google, Outlook, iCal, CalDAV).
- Хранилища файлов (S3, Dropbox, SharePoint).
- Бизнес-аналитика (Power BI, Tableau, Metabase).
- DevOps/CI (GitHub, GitLab) для контроля изменений конфигураций.

**API**
- REST и частично GraphQL (экспериментальный).
- Аутентификация через OAuth2, API-токены, JWT с ограничениями по scopes.
- Ограничение запросов, подписанные вебхуки, HMAC.
- Документация через Swagger/OpenAPI, SDK для PHP, Node.js, Python.

**ETL и синхронизация**
- Плановые выгрузки в хранилища (data lake) для BI.
- Инкрементальные обновления, отслеживание дельт по `updatedAt`.
- Очереди (Redis/Beanstalkd/SQS) для асинхронной обработки.
- Контроль качества данных, мониторинг отказов.

**Инструменты разработчика**
- Sandbox-режим, тестовые токены.
- Mock-серверы, Postman-коллекции.
- Встроенные логгеры и просмотр последних запросов/ответов.
- Event Replay для восстановления состояния после ошибок.

---

### A.8 Безопасность, соответствие и DevSecOps

**Процессы**
- Управление уязвимостями: регулярные сканы, triage, remediation.
- Pen-test отчёты, программы bug bounty.
- Управление секретами (Vault, KMS), аудит доступа к секретам.
- Политика резервного копирования: daily/weekly, тесты восстановления.

**Соответствие**
- ISO 27001, SOC2, GDPR, локальные законы о защите данных.
- Регламенты хранения данных, ретеншн политики, анонимизация.
- Журналы доступа к PII, Data Processing Agreements.

**DevSecOps практики**
- CI/CD pipeline с проверками (lint, тесты, SAST, DAST).
- Infrastructure as Code (Terraform/Ansible) для реплицирования окружений.
- Secrets scanning, dependency monitoring, подписанные сборки.
- Политика ветвления, обязательные code review.

**Инцидент-менеджмент**
- План реагирования, роли (Incident Commander, Comms, Scribe).
- Автоматические уведомления, шаблоны сообщений.
- Post-incident review, action items, отслеживание выполнения.

---

### A.9 Конфигурация, кастомизация и расширения UI

**Темизация**
- Настройки бренда: логотипы, цвета, типографика.
- Тонкая настройка компонентов через CSS variables.
- Тёмная тема, high-contrast режим.
- Поддержка кастомных шаблонов email и PDF.

**Расширения UI**
- Виджеты на главной странице: KPI, задачи, активные проекты, уведомления.
- Динамические формы: условные поля, зависимости, автоподстановка.
- Custom scripts (в ограниченном sandbox), интеграция с BI панели внутри UI.
- Персональные dashboards для ролей.

**Многоязычность**
- Файлы переводов, поддержка pluralization, fallback.
- Перевод пользовательского контента, автоматическая локализация дат/валют.
- Процесс добавления нового языка (экспорт шаблона, перевод, QA).

**Accessibility**
- Соответствие WCAG 2.1 AA.
- Поддержка клавиатурной навигации, screen reader hints.
- Проверка контраста, подсказки для форм.

---

### A.10 Обслуживание, миграции и эксплуатационные процедуры

**Миграции**
- Жизненный цикл Phinx-макетов: разработка, review, тесты, деплой.
- Управление версиями схемы, генерация `schema.php`.
- Роллбэки, тесты обратной совместимости.

**Обслуживание**
- Плановые окна обслуживания, нотификации.
- Мониторинг ресурсов: CPU, RAM, DB connections, latency.
- Алёрты в Slack/Teams/Email, интеграция с OpsGenie, PagerDuty.

**Резервное копирование**
- Full и incremental backups, шифрование, хранение на S3/Glacier.
- Политика retention (30/90/365 дней), автоматическое удаление просроченных.
- План восстановления (RPO/RTO), тестовые восстановления раз в квартал.

**Обновление приложения**
- Canary-развёртывания, blue/green стратегии.
- Проверка совместимости миграций, smoke-тесты.
- Документация release notes, коммуникация пользователям.

**Наблюдаемость**
- Метрики Prometheus/Grafana, дашборды.
- Логи (ELK), трассировки (OpenTelemetry).
- Synthetic monitoring (Pingdom, NewRelic).

---

### A.11 Справочники данных и каталог конфигурации

**Ключевые справочники**
- Валюты, единицы измерения, налоговые ставки, типы контрактов.
- Типы событий, категорий задач, причин отмены.
- Типы инцидентов, уровни критичности, SLA.
- Географические справочники (страны, регионы, города).

**Управление справочниками**
- Ручное редактирование, массовый импорт, API.
- Версионирование записей, аудит изменений.
- Публикация в клиентском портале.

**Конфигурация бизнес-правил**
- Регламенты утверждения, лимиты, маршруты.
- Сценарии автоматизации (if-this-then-that).
- Управление сценариями тестирования.

**Метаданные**
- Документация схем, ER-диаграммы.
- Описание полей, типы, обязательность, формат.
- Примеры использования, сценарии валидации.

---

### A.12 Обучение, поддержка пользователей и база знаний

**Онбординг**
- Тур по продукту, интерактивные подсказки, видеоуроки.
- Чек-лист внедрения, шаблоны писем.
- План обучения по ролям (администратор, менеджер, техник).

**База знаний**
- Категории: Начало работы, Управление проектами, Финансы, Интеграции, Безопасность.
- Форматы: статьи, видео, инфографика, шаблоны.
- Процесс обновления: автор ➜ редактор ➜ публикация ➜ review.

**Поддержка**
- Каналы: email, чат, телефон, self-service портал.
- SLA: время ответа, время решения, эскалация.
- Инструменты: Zendesk/Freshdesk интеграция, макросы, automation rules.

**Сбор обратной связи**
- NPS опросы, CSAT, CES.
- Сбор идей (feature requests), голосование, roadmap portal.
- Анализ отзывов, формирование backlog улучшений.

---

### A.13 Аналитика, отчётность и BI

**Источники данных**
- Production DB (реплика), аналитическое хранилище, логи событий.
- Инкрементальные пайплайны с CDC.
- Data warehouse (Snowflake/BigQuery/Redshift).

**Модели данных**
- Звёздная схема (факт/измерения) для проектов, финансов, инвентаря.
- Семантический слой (LookML/Power BI datasets).
- Data marts для разных ролей.

**Отчёты**
- Финансовые, операционные, SLA, клиентские.
- Dashboards для руководства, middle management, сотрудников.
- Ад-хок аналитика через SQL Lab/Metabase.

**Рассылка отчётов**
- Плановые отправки, PDF/Excel.
- Alerts при отклонениях KPI.
- Экспорт в SFTP, email, Slack.

**Data Governance**
- Классификация данных, каталог (Data Catalog).
- Политики доступа, маскирование, row-level security.
- Линейка происхождения (data lineage), контроль качества.

---

### A.14 Мобильные приложения и полевые операции

**Функциональность**
- Просмотр проектов, задач, расписаний.
- Инвентаризация: сканирование QR/штрихкодов, списание, перемещение.
- Офлайн режим: локальный кеш, синхронизация при подключении.
- Push-уведомления, геолокация, чек-ин/чек-аут.

**Безопасность**
- MDM-поддержка, политики устройства.
- Шифрование данных на устройстве, биометрическая аутентификация.
- Удалённый wipe при потере.

**Интеграция**
- API, вебхуки для синхронизации.
- Поддержка мобильных SDK для сканеров.
- Логи синхронизации, диагностика.

---

### A.15 Тестирование, качество и QA-процессы

**Типы тестов**
- Unit, Integration, E2E, UI, Load, Security, Accessibility.
- Smoke-тесты после деплоя, regression-suite.

**Инструменты**
- PHPUnit, Cypress/Playwright, Postman/Newman, JMeter/Gatling.
- Static analysis (Psalm, PHPStan), линтеры.
- Coverage отчёты, SonarQube.

**Процессы**
- QA в CI/CD, тестовые окружения, sandbox.
- Bug triage, приоритизация, SLA исправлений.
- Чек-листы релизов, sign-off.

**Документация**
- Test plans, test cases, traceability matrix.
- Отчёты о регрессии, метрики дефектов.

---

### A.16 Партнёрская экосистема и расширения

**Типы партнёров**
- Интеграторы, MSP, франчайзи, технологические партнёры.
- Реселлеры, обучающие центры.

**Программы**
- Портал партнёров, обучение, сертификация.
- Маркетинговые материалы, MDF.
- Совместные проекты, распределение ролей.

**Маркетплейс расширений**
- Каталог, рейтинг, отзывы.
- Процесс модерации, обновления.
- SDK, API, guidelines.

---

### A.17 Будущие дорожные карты и инновации

**Направления развития**
- Искусственный интеллект: прогнозирование спроса, автоматизация планирования.
- AR/VR для визуализации площадок.
- IoT интеграции для мониторинга оборудования.
- Carbon accounting, ESG отчётность.

**Эксперименты**
- Feature flags, A/B тесты, бета-программы.
- Customer advisory board, исследование UX.

**Метрики успеха**
- Adoption rate, churn, NPS, ROI.
- Производительность команд, снижение ошибок.

---

### A.18 Глоссарий терминов

| Термин | Определение | Важные нюансы |
| --- | --- | --- |
| Инстанс | Изолированная организация в AdamRMS | Включает собственные настройки, пользователей, домены |
| Роль | Набор прав доступа | Может наследовать права, поддерживает временные ограничения |
| Комплект | Набор связанных единиц инвентаря | Используется для быстрой выдачи оборудования на проекты |
| Смета | Финансовый документ проекта | Содержит плановые расходы, утверждается клиентом |
| Change Request | Запрос на изменение | Требует оценки влияния, согласований, актуализирует план |
| SLA | Соглашение об уровне сервиса | Определяет метрики времени реакции, доступности |
| KPI | Ключевые показатели эффективности | Отчёты формируются в аналитике и BI |
| Наблюдаемость | Совокупность логов, метрик, трассировок | Помогает диагностировать проблемы в продакшене |
| ETL | Extract-Transform-Load | Используется для выгрузки данных в аналитические системы |
| ESG | Экологические, социальные и управленческие показатели | Раздел отчётности для клиентов и инвесторов |

---

### A.19 Контрольные списки и чек-листы

**Онбординг нового инстанса**
1. Создать инстанс, назначить владельца.
2. Заполнить базовую конфигурацию (домен, бренд, время).
3. Настроить email/SMS интеграции.
4. Импортировать пользователей и роли.
5. Импортировать справочники и инвентарь.
6. Настроить финансовые параметры и налоги.
7. Проверить логику уведомлений.
8. Провести обучающую сессию.

**Запуск нового проекта**
1. Создать карточку проекта, заполнить бриф.
2. Подтвердить бюджет и согласовать договор.
3. Забронировать ресурсы и персонал.
4. Составить расписание и чек-листы.
5. Настроить каналы связи.
6. Подготовить логистику и инвентарь.
7. Провести kick-off встречу.
8. Зафиксировать риски, mitigation.

**Еженедельный операционный контроль**
1. Проверить отчёты по проектам и задачам.
2. Обновить статусы инвентаря.
3. Сверить финансовые показатели с планом.
4. Проверить уведомления и коммуникации.
5. Просмотреть логи безопасности.
6. Обновить roadmap улучшений.

**Релиз приложения**
1. Обновить ветку, пройти CI.
2. Применить миграции на staging.
3. Провести regression тесты.
4. Подготовить release notes.
5. Уведомить пользователей.
6. Деплой на production (canary).
7. Мониторинг метрик.
8. Собрать обратную связь.

---

### A.20 Матрица соответствия функций требованиям клиентов

| Требование клиента | Функция AdamRMS | Настройки/интеграции | Метрики успеха |
| --- | --- | --- | --- |
| Прозрачность проектов | Карточки проектов, клиентский портал | Шаблоны уведомлений, права доступа | Сроки ответов, удовлетворённость |
| Контроль инвентаря | Каталог активов, логистика | QR-сканирование, статусы | Доступность, процент повреждений |
| Финансовая точность | Бюджеты, счета, интеграции с бухгалтерией | Налоговые настройки, курсы валют | План-факт, дебиторка |
| Безопасность данных | RBAC, аудит, 2FA | Политики паролей, SSO | Количество инцидентов |
| Автоматизация | Workflow, вебхуки, API | Интеграции с ERP/CRM | Время обработки, сниженные ошибки |
| Аналитика | Отчёты, dashboards, BI интеграции | Data warehouse, ETL | Доля руководителей, использующих отчёты |

---

### A.21 Истории пользователей и сценарии (User Stories)

- Как **менеджер проекта**, я хочу получить уведомление, если оборудование не вернулось вовремя, чтобы оперативно связаться с ответственным.
- Как **инженер по инвентарю**, я хочу провести мобильную проверку комплекта на площадке оффлайн, чтобы ввести данные после восстановления сети.
- Как **финансовый директор**, я хочу сравнить плановую и фактическую маржинальность, чтобы корректировать бюджет следующего проекта.
- Как **клиент**, я хочу просматривать статусы задач и документов в портале, чтобы понимать прогресс.
- Как **администратор безопасности**, я хочу быть уведомлён при выдаче новых API-токенов, чтобы контролировать доступ.
- Как **оператор поддержки**, я хочу видеть последние коммуникации с клиентом, чтобы давать информированные ответы.
- Как **аналитик**, я хочу выгружать данные в Power BI, чтобы строить кастомные отчёты.
- Как **инженер DevOps**, я хочу иметь возможность запускать миграции и проверять их статус, чтобы гарантировать стабильность.

---

### A.22 Пошаговые руководства (How-To)

**Как настроить новый шаблон договора**
1. Зайдите в раздел «Финансы» → «Шаблоны документов».
2. Создайте новую версию, укажите язык, валюту, налоговый режим.
3. Используйте переменные (`{{project.name}}`, `{{client.company}}`, `{{finance.total}}`).
4. Настройте условия видимости (по типу проекта, региону).
5. Сохраните, протестируйте на демо-проекте, отправьте на утверждение.
6. Опубликуйте, добавьте в чек-листы проекта.

**Как подключить Slack-интеграцию**
1. Откройте «Интеграции» → «Slack».
2. Нажмите «Подключить», пройдите OAuth.
3. Выберите рабочее пространство, каналы для уведомлений.
4. Настройте маршрутизацию (по проектам, типам событий).
5. Проверьте здоровье интеграции, отправьте тестовое сообщение.
6. Включите автоматическое создание каналов для новых проектов.

**Как выполнять аудит безопасности**
1. Перейдите в «Безопасность» → «Аудит».
2. Отфильтруйте события по типу (вход, изменение прав, экспорт).
3. Выгрузите отчёт за период, проанализируйте аномалии.
4. Проверьте статус 2FA для критических ролей.
5. Проверьте журналы API-токенов и сессий.
6. Оформите инциденты, запланируйте remedial actions.

---

### A.23 Примеры структур данных и схем

**JSON ответа проекта**
```json
{
  "id": 1024,
  "code": "PRJ-2024-015",
  "name": "Конференция A/V",
  "status": "in_progress",
  "client": {
    "id": 87,
    "name": "TechCorp",
    "contact": "alex@techcorp.com"
  },
  "budget": {
    "planned": 1500000,
    "actual": 1435000,
    "currency": "RUB"
  },
  "schedule": {
    "start": "2024-05-12",
    "end": "2024-05-17",
    "phases": [
      { "name": "Подготовка", "start": "2024-04-20", "end": "2024-05-11" },
      { "name": "Событие", "start": "2024-05-12", "end": "2024-05-17" },
      { "name": "Постпроизводство", "start": "2024-05-18", "end": "2024-05-25" }
    ]
  }
}
```

**Структура записи инвентаря (YAML)**
```yaml
id: 5501
sku: "LED-PANEL-4K"
serial: "LP4K-2021-0098"
category: "Video"
location: "Main Warehouse"
status: "available"
purchaseCost: 3200
currency: "USD"
warranty:
  expiresAt: "2025-09-30"
  provider: "VisualTech"
maintenance:
  lastServiceAt: "2023-10-01"
  nextServiceDue: "2024-04-01"
linkedAccessories:
  - "Power Cable"
  - "Flight Case"
  - "Mounting Kit"
```

**Схема webhook события (Markdown)**
```markdown
- `eventId`: UUID события
- `eventType`: `project.updated`
- `timestamp`: ISO8601
- `instanceId`: идентификатор инстанса
- `signature`: HMAC-SHA256
- `payload`:
  - `projectId`
  - `changes`: список полей (старое/новое значение)
  - `actor`: пользователь или сервис
```

---

### A.24 Таблица зависимостей модулей

| Модуль | Зависит от | Предоставляет |
| --- | --- | --- |
| Управление инстансами | Аутентификация, Конфигурация | Роли, Настройки, Интеграции |
| Пользователи | Аутентификация, Инстансы | Матрица прав, Аудит |
| Инвентарь | Инстансы, Проекты, Финансы | Резервы, Отчёты, Логистика |
| Проекты | Пользователи, Инвентарь, Финансы, Коммуникации | Расписания, Документы, Таск-менеджмент |
| Финансы | Проекты, Клиенты, Инвентарь | Бюджеты, Счета, Отчёты |
| Коммуникации | Пользователи, Проекты, Финансы | Уведомления, Портал |
| Аналитика | Все модули | BI, Отчёты, Метрики |
| Интеграции | Аутентификация, Проекты, Финансы | API, Вебхуки, Синхронизация |
| DevOps/Обслуживание | Инфраструктура, Безопасность | Деплой, Мониторинг |

---

### A.25 Дополнительные регламенты и лучшие практики

**Управление изменениями**
- Чёткие процессы RFC, CAB, оценка влияния.
- План коммуникаций, уведомления пользователей.
- Back-out планы, тестирование после изменений.

**Документооборот**
- Версионирование документов, хранение оригиналов.
- Контроль доступа, электронные подписи.
- Автоматическое архивирование завершённых проектов.

**Юридические аспекты**
- Политика обработки персональных данных.
- Договоры с подрядчиками, NDAs.
- Условия использования, SLA с клиентами.

**Управление знаниями**
- Ретроспективы, lessons learned.
- Репозитории шаблонов, best practices.
- Обновление базы знаний на основе инцидентов.

**Экологическая устойчивость**
- Учёт энергопотребления оборудования.
- Переработка и повторное использование материалов.
- Отчёты по CO2, ESG показатели.

---

### A.26 Карты процессов (BPMN/Flow) — текстовое описание

**Пример процесса «Утверждение бюджета»**
1. Менеджер проекта создаёт смету.
2. Система проверяет полноту данных (бюджет, налоги, валюты).
3. Если превышает лимит, добавляется этап согласования с финансовым директором.
4. Клиент получает уведомление, подтверждает или запрашивает изменения.
5. После утверждения запускаются автоматизации (резервирование ресурсов, создание расписания).
6. Система логирует действия, обновляет статусы, инициирует напоминания о платежах.

**Процесс «Возврат инвентаря»**
1. Техник инициирует процедуру возврата.
2. Система формирует чек-лист, отправляет уведомления ответственным.
3. На складе выполняется сканирование, отмечаются повреждения.
4. Если требуется ремонт, создаётся заявка в `assetMaintenance`.
5. Финансовый модуль рассчитывает потенциальные штрафы.
6. Логи обновляются, клиент уведомляется о результатах.

---

### A.27 Интеграция с внешними системами: детализация сценариев

**CRM (Salesforce, HubSpot)**
- Синхронизация лидов и сделок, автоматическое создание проектов.
- Маппинг полей, обработка дублей, правила приоритетов.
- Обратная синхронизация статусов и отчётов.

**HRIS (BambooHR, SAP SuccessFactors)**
- Импорт сотрудников, ролей, навыков.
- Синхронизация расписаний, отпусков, доступности.
- Обновление статусов сертификаций, compliance.

**Ticketing (Jira, ServiceNow)**
- Создание задач/инцидентов из проектов.
- Синхронизация статусов, комментариев, вложений.
- Автоматическая маршрутизация по типу запроса.

**IoT/Телеметрия**
- Подключение сенсоров (температура, вибрация, питание).
- Реакция на триггеры: уведомления, блокировка бронирований.
- Хранение истории, аналитика.

---

### A.28 Подробные регистры логов и мониторинга

**Логи приложений**
- `app.log` — общие события, уровни INFO/WARN/ERROR.
- `auth.log` — входы, попытки, блокировки.
- `finance.log` — счета, платежи, ошибки интеграций.
- `integration.log` — вебхуки, запросы API, таймауты.

**Мониторинг**
- Метрики приложений: RPS, latency, error rate.
- Метрики базы данных: slow queries, lock waits, replication lag.
- Метрики инфраструктуры: CPU, memory, disk I/O.
- Дашборды по сервисам, алёрты.

**Хранение и ретеншн**
- Временные окна: 30 дней (горячие), 180 дней (тёплые), 365+ (архив).
- Маскирование чувствительных данных.
- Поиск и фильтры (Kibana, Grafana Loki).

---

### A.29 Специфичные сценарии отраслей (Verticals)

**Event Production**
- Управление ареной, сценой, светом, звуком.
- Координация подрядчиков, лицензии, разрешения.
- Управление билетами, взаимодействие с Ticketing.

**Broadcast/Media**
- Планирование трансляций, расписания студий.
- Интеграция с MAM/DAM, Play-out системами.
- Управление правами на контент, архивы.

**Rental/Equipment Houses**
- Каталоги аренды, динамическое ценообразование.
- Онлайн-бронирование, интеграция с e-commerce.
- Управление договорами аренды, страхованием.

**Corporate AV/IT**
- Управление конференц-залами, ресурсами.
- Сервисные заявки, SLA.
- Интеграция с корпоративным IAM.

---

### A.30 Политики и стандарты документации

**Документы**
- Руководства пользователя, администратора, API.
- SOP (Standard Operating Procedures), WI (Work Instructions).
- Регламенты безопасности, инцидент-менеджмента.

**Процессы обновления**
- Версионирование документов, changelog.
- Плановые ревью, аудит устаревших материалов.
- Перевод документации, локализация.

**Хранение**
- Централизованный репозиторий, права доступа.
- Электронная подпись, подтверждение прочтения.
- Поиск, категоризация, теги.

---

### A.31 Сценарии disaster recovery и business continuity

**Планирование**
- Определение критичных сервисов, RPO/RTO.
- Анализ рисков (природные, техногенные, кибер).
- Матрица ответственных.

**Действия при отказе**
- Переключение на резервный регион/датацентр.
- Восстановление из бэкапа, проверка целостности.
- Коммуникация с клиентами, отчётность.

**Тесты**
- Tabletop-упражнения, полнофункциональные DR-тесты.
- Документация результатов, улучшение планов.

---

### A.32 Экосистема данных и AI-модули (экспериментально)

**Модули**
- Прогнозирование загрузки инвентаря.
- Рекомендации по ресурсам на основе прошлых проектов.
- Автоматическое составление расписаний.
- Анализ текстов (обратная связь, коммуникации).

**Данные**
- Исторические проекты, показатели качества.
- Телеметрия оборудования.
- Финансовые показатели, сезонность.

**Этика и контроль**
- Объяснимость моделей, документация решений.
- Обновление моделей, мониторинг деградации.
- Privacy: анонимизация, контроль доступа.

---

### A.33 Подробное сравнение планов и тарифов

| План | Инстансы | Пользователи | Инвентарь | Интеграции | Поддержка | Безопасность |
| --- | --- | --- | --- | --- | --- | --- |
| Starter | 1 | До 50 | Базовые функции | Ограниченные (email) | Email 5/7 | 2FA, базовый аудит |
| Professional | До 5 | До 500 | Расширенные, комплекты, логистика | Slack, календарь, бухгалтерия | Email/чат 24/5 | SSO, расширенный аудит |
| Enterprise | Без ограничений | 500+ | Полный функционал, IoT, кастомные отчёты | Все интеграции, API rate-up | 24/7, выделенный менеджер | SOC2, SSO/SAML, DLP |
| Government | Выделенные | Политики госуровня | Параметры хранения, сертификации | Интеграции по требованиям | 24/7, onsite | FedRAMP, GOST |

**Дополнительные опции**
- White-label, кастомные SLA, выделенный хостинг.
- Пакеты часов внедрения, обучение.
- Дополнительные модули (AI, IoT, partner marketplace).

---

### A.34 Система показателей эффективности внедрения

**Метрики внедрения**
- Время развёртывания, обучение пользователей.
- Процент активных пользователей спустя 30/60/90 дней.
- Количество автоматизированных процессов.
- Снижение времени подготовки проекта.

**Метрики результата**
- Увеличение дохода от аренды/услуг.
- Снижение ошибок логистики.
- Повышение удовлетворённости клиентов.
- Снижение операционных затрат.

**Сбор данных**
- Анкеты, аналитика использования, интеграции с ERP.
- Контрольные встречи с заказчиком.

---

### A.35 Вопросы и ответы (FAQ) расширенный

**Q:** Как ограничить доступ подрядчика только к конкретным проектам?
**A:** Создайте роль с разрешениями `PROJECT:VIEW` и назначьте её только на нужные проекты через `projectAssignments`. Используйте фильтры в клиентском портале и убедитесь, что у роли отключены глобальные права.

**Q:** Можно ли автоматически распределять оборудование между проектами по приоритетам?
**A:** Да, используйте модуль планирования с приоритетами. Настройте веса и правила конфликтов, активируйте автоматическую перераспределяющую задачу cron.

**Q:** Как отследить, кто изменил смету?
**A:** В журнале `financeAudit` есть запись `BUDGET_UPDATED` с деталями полей. В UI доступен diff и подпись утвердившего.

**Q:** Поддерживается ли импорт данных из старой системы?
**A:** Да, через CSV, API или ETL-коннекторы. Предусмотрен мастер миграции с проверкой данных.

**Q:** Что делать при конфликте резервирования оборудования?
**A:** Система предложит альтернативы, уведомит менеджера. Можно настроить автоматическое переназначение или workflow согласования.

**Q:** Как контролировать соответствие требованиям GDPR?
**A:** Включите настройки конфиденциальности, используйте анонимизацию, ведите логи доступа к PII, предоставляйте экспорт/удаление данных по запросу.

**Q:** Есть ли поддержка offline режимов?
**A:** Да, мобильные приложения и PWA поддерживают оффлайн. Данные кешируются, при восстановлении соединения выполняется синхронизация.

**Q:** Как отслеживать SLA по поддержке?
**A:** Используйте модуль тикетов или интеграцию с сервис-деском. Настройте метрики и отчёты, автоматические напоминания и эскалацию.

**Q:** Возможно ли настроить различные налоговые ставки для разных регионов?
**A:** Да, используйте справочник налогов с региональными правилами. При создании проекта укажите регион, и система подставит нужные ставки.

**Q:** Как обезопасить API-токены?
**A:** Ограничьте IP, установите срок действия, включите уведомления о создании/использовании, применяйте HMAC подпись.

---

### A.36 Хронология релизов (Release Timeline) — пример

| Версия | Дата | Основные изменения | Примечания |
| --- | --- | --- | --- |
| 3.0 | 2024-04-15 | Новый модуль AI планирования, обновление мобильного приложения | Требует обновления миграций 2024041501 |
| 2.9 | 2024-02-10 | Улучшения финмодуля, интеграция с PayPal | Нужно включить флаг `FINANCE_PAYPAL_ENABLED` |
| 2.8 | 2023-12-20 | Переход на новую архитектуру уведомлений | Провести миграцию шаблонов |
| 2.7 | 2023-10-05 | Канбан-доска проектов, расширенные отчёты | Новый API `/api/projects/board` |

---

### A.37 Карта заинтересованных сторон (Stakeholder Map)

- Внутренние: руководство, менеджеры, инженеры, логистика, финансы, IT/DevOps, безопасность, поддержка.
- Внешние: клиенты, подрядчики, поставщики, партнёры, регуляторы.
- Влияние/интерес: матрица, определение каналов коммуникации, частоты отчётности.

---

### A.38 Регламенты качества данных

**Политики**
- Точность, полнота, актуальность, согласованность, уникальность.
- Проверки при импорте, ежедневные отчёты о качестве.
- Процедуры исправления, ответственные лица.

**Инструменты**
- Правила валидации, регулярные SQL проверки.
- Автоматические уведомления при нарушениях.
- Каталог данных с описанием качества.

---

### A.39 Платформенные ограничения и квоты

- Лимиты API запросов (по ключу, по инстансу, по IP).
- Ограничения на количество проектов, активов, пользователей в плане.
- Лимиты хранения файлов (S3 buckets, ретеншн, версии).
- Ограничения по интеграциям (количество подключений, частота обновлений).
- Политика fair usage, уведомления при превышении.

---

### A.40 Приложение: карты пользовательских путей (User Journey)

**Пример: Менеджер проекта**
1. Получает лид → создаёт проект → заполняет бриф.
2. Планирует ресурсы, утверждает бюджет.
3. Настраивает коммуникации, назначает задачи.
4. Контролирует исполнение, реагирует на риски.
5. Закрывает проект, анализирует результаты.

**Пример: Клиент**
1. Получает приглашение → создаёт аккаунт.
2. Просматривает проект, подтверждает сметы.
3. Отслеживает прогресс, оставляет комментарии.
4. Получает отчёт, подписывает документы.
5. Оставляет отзыв, участвует в NPS.

**Пример: Техник**
1. Получает список задач, комплект оборудования.
2. Сканирует оборудование, подтверждает готовность.
3. Выполняет работы на площадке, фиксирует изменения.
4. Возвращает оборудование, отмечает повреждения.
5. Отчитывается, обновляет статусы.

---

