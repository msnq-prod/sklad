{% extends "assets/template.twig" %}
{% block content %}

<div class="row justify-content-center">
    <div class="col-12 col-lg-6">
        <div class="card">
			<div class="card-header">
				<ul class="nav nav-pills">
					<li class="nav-item"><a class="nav-link" href="{{CONFIG.ROOTURL}}/instances/navigation.php"><i class="fas fa-arrow-left"></i> Назад к настройкам</span></a></li>
					{% if "BUSINESS:USERS:VIEW:LIST"|instancePermissions %}
					<li class="nav-item"><a class="nav-link" href="{{CONFIG.ROOTURL}}/instances/users.php">Пользователи/a></li>
					{% endif %}
					{% if "BUSINESS:ROLES_AND_PERMISSIONS:VIEW"|instancePermissions %}
					<li class="nav-item"><a class="nav-link" href="{{CONFIG.ROOTURL}}/instances/permissions.php">Права доступа/a></li>
					{% endif %}
					{% if "BUSINESS:USER_SIGNUP_CODES:VIEW"|instancePermissions %}
					<li class="nav-item"><a class="nav-link" href="{{CONFIG.ROOTURL}}/instances/signupCodes.php">Коды регистрации/a></li>
					{% endif %}
					{% if "BUSINESS:SETTINGS:EDIT:TRUSTED_DOMAINS"|instancePermissions %}
					<li class="nav-item"><a class="nav-link active" href="{{CONFIG.ROOTURL}}/instances/trustedDomains.php">Доверенные домены</a></li>
					{% endif %}
				</ul>
			</div>
		</div>
        <div class="card">
            <form id="settings">
                <div class="card-header">
                    <h3 class="card-title">Доверенные домены</h3>
                </div>
                <div class="card-body">
                    <p>Доверенные домены позволяют пользователям {{ CONFIG.PROJECT_NAME }} с подтверждёнными адресами электронной почты присоединяться к вашей компании, если их почта соответствует одному из доменов ниже.
                    <br/><br/>Они похожи на коды регистрации: тоже дают доступ к компании, но работают автоматически и доступны каждому пользователю с доменом из списка.</p>
                    <hr/>
                    <div class="form-group">
                        <label>Доверенные домены</label>
                        <input type="text" class="form-control" name="domains" value="{{instanceTrustedDomains.domains|join(',')}}" aria-describedby="domainsHelp" />
                        <small id="domainsHelp" class="form-text text-muted">Разделяйте значения запятой</small>
                    </div>
                    <div class="form-group">
                        <label>Группа ролей</label>
                        <select class="form-control" name="instancePositions_id">
                            {% for position in positions %}
                                <option {{ instanceTrustedDomains.instancePositions_id == position.instancePositions_id ? 'selected' : '' }} value="{{ position.instancePositions_id }}">{{ position.instancePositions_displayName }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Роль</label>
                        <input type="text" class="form-control" name="userInstances_label" value="{{ instanceTrustedDomains.userInstances_label }}">
                    </div>
                </div>
                <div class="card-footer">
                    <button type="submit" class="btn btn-default save">Сохранить</button>
                </div>
            </form>
        </div>
   </div>
    <script>
        $(document).ready(function() {
            $("#settings").on("submit", function(e){
                e.preventDefault();
            });
            $('.save').on('click', function() {
                var formData = $("#settings").serializeArray();
                ajaxcall("instances/editInstanceTrustedDomains.php", {formData});
            });
        });
    </script>
</div>

{% endblock %}
